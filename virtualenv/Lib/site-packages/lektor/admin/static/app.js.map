{"version":3,"file":"app.js","mappings":"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","sources":["webpack://lektor/./js/components/AdminLink.tsx","webpack://lektor/./js/components/AdminLinkWithHotkey.tsx","webpack://lektor/./js/components/DialogSlot.tsx","webpack://lektor/./js/components/ErrorDialog.tsx","webpack://lektor/./js/components/ServerStatus.tsx","webpack://lektor/./js/components/SlideDialog.tsx","webpack://lektor/./js/components/ToggleGroup.tsx","webpack://lektor/./js/components/use-go-to-admin-page.ts","webpack://lektor/./js/context/page-context.ts","webpack://lektor/./js/context/record-context.ts","webpack://lektor/./js/dialogs/Publish.tsx","webpack://lektor/./js/dialogs/Refresh.tsx","webpack://lektor/./js/dialogs/find-files/FindFiles.tsx","webpack://lektor/./js/dialogs/find-files/ResultRow.tsx","webpack://lektor/./js/error-dialog.ts","webpack://lektor/./js/events.ts","webpack://lektor/./js/fetch.ts","webpack://lektor/./js/header/BreadCrumbs.tsx","webpack://lektor/./js/header/GlobalActions.tsx","webpack://lektor/./js/header/Header.tsx","webpack://lektor/./js/i18n.tsx","webpack://lektor/./js/main.tsx","webpack://lektor/./js/sidebar/Alternatives.tsx","webpack://lektor/./js/sidebar/AttachmentActions.tsx","webpack://lektor/./js/sidebar/ChildActions.tsx","webpack://lektor/./js/sidebar/ChildPagination.tsx","webpack://lektor/./js/sidebar/PageActions.tsx","webpack://lektor/./js/sidebar/Sidebar.tsx","webpack://lektor/./js/sidebar/constants.ts","webpack://lektor/./js/slugify.ts","webpack://lektor/./js/userLabel.tsx","webpack://lektor/./js/utils.ts","webpack://lektor/./js/views/AddAttachmentPage.tsx","webpack://lektor/./js/views/App.tsx","webpack://lektor/./js/views/PreviewPage.tsx","webpack://lektor/./js/views/add-child-page/AddChildPage.tsx","webpack://lektor/./js/views/add-child-page/AvailableModels.tsx","webpack://lektor/./js/views/add-child-page/PrimaryFieldRow.tsx","webpack://lektor/./js/views/add-child-page/Slug.tsx","webpack://lektor/./js/views/delete/DeletableAlternatives.tsx","webpack://lektor/./js/views/delete/DeletableAttachments.tsx","webpack://lektor/./js/views/delete/DeletableChildPages.tsx","webpack://lektor/./js/views/delete/DeleteAllAltsChoice.tsx","webpack://lektor/./js/views/delete/DeletePage.tsx","webpack://lektor/./js/views/delete/DeletePageActions.tsx","webpack://lektor/./js/views/delete/DeletePageHeader.tsx","webpack://lektor/./js/views/edit/EditPage.tsx","webpack://lektor/./js/views/edit/EditPageActions.tsx","webpack://lektor/./js/widgets.tsx","webpack://lektor/./js/widgets/BooleanInputWidget.tsx","webpack://lektor/./js/widgets/CheckboxesInputWidget.tsx","webpack://lektor/./js/widgets/DateInputWidget.tsx","webpack://lektor/./js/widgets/FloatInputWidget.tsx","webpack://lektor/./js/widgets/InputWidgetBase.tsx","webpack://lektor/./js/widgets/IntegerInputWidget.tsx","webpack://lektor/./js/widgets/MultiLineTextInputWidget.tsx","webpack://lektor/./js/widgets/SelectInputWidget.tsx","webpack://lektor/./js/widgets/SingleLineTextInputWidget.tsx","webpack://lektor/./js/widgets/SlugInputWidget.tsx","webpack://lektor/./js/widgets/UrlInputWidget.tsx","webpack://lektor/./js/widgets/fakeWidgets.tsx","webpack://lektor/./js/widgets/flow/AddFlowBlockButtons.tsx","webpack://lektor/./js/widgets/flow/FlowBlock.tsx","webpack://lektor/./js/widgets/flow/FlowWidget.tsx","webpack://lektor/./js/widgets/flow/metaformat.tsx","webpack://lektor/./js/widgets/types.ts","webpack://lektor/./scss/main.scss?3365","webpack://lektor/webpack/bootstrap","webpack://lektor/webpack/runtime/chunk loaded","webpack://lektor/webpack/runtime/compat get default export","webpack://lektor/webpack/runtime/define property getters","webpack://lektor/webpack/runtime/global","webpack://lektor/webpack/runtime/hasOwnProperty shorthand","webpack://lektor/webpack/runtime/make namespace object","webpack://lektor/webpack/runtime/jsonp chunk loading","webpack://lektor/webpack/before-startup","webpack://lektor/webpack/startup","webpack://lektor/webpack/after-startup"],"sourcesContent":["import React, { forwardRef, memo, ForwardedRef, ReactNode } from \"react\";\nimport { NavLink } from \"react-router-dom\";\nimport { PageName } from \"../context/page-context\";\nimport { RecordPathDetails, useRecord } from \"../context/record-context\";\nimport { adminPath } from \"./use-go-to-admin-page\";\n\nfunction AdminLink(\n  {\n    page,\n    path,\n    alt,\n    children,\n    ...otherProps\n  }: RecordPathDetails & {\n    page: PageName;\n    children: ReactNode;\n    onClick?: React.MouseEventHandler<HTMLAnchorElement>;\n    title?: string;\n  },\n  ref: ForwardedRef<HTMLAnchorElement | null>\n): JSX.Element {\n  const current = useRecord();\n  const recordMatches = path === current.path && alt === current.alt;\n\n  return (\n    <NavLink\n      to={adminPath(page, path, alt)}\n      activeClassName=\"active\"\n      isActive={(match) => recordMatches && match != null}\n      {...otherProps}\n      ref={ref}\n    >\n      {children}\n    </NavLink>\n  );\n}\n\nexport default memo(forwardRef(AdminLink));\n","import React, {\n  MutableRefObject,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useRef,\n} from \"react\";\nimport { PageName } from \"../context/page-context\";\nimport { RecordPathDetails } from \"../context/record-context\";\nimport { getKey, KeyboardShortcut, keyboardShortcutHandler } from \"../utils\";\nimport AdminLink from \"./AdminLink\";\n\n/**\n * React hook to add a global keyboard shortcut for the given\n * key for the lifetime of the component.\n */\nfunction useKeyboardShortcut(\n  key: KeyboardShortcut,\n  action: (ev: KeyboardEvent) => void\n): void {\n  useEffect(() => {\n    const handler = keyboardShortcutHandler(key, action);\n    window.addEventListener(\"keydown\", handler);\n    return () => window.removeEventListener(\"keydown\", handler);\n  }, [key, action]);\n}\n\n/**\n * Add a global keyboard shortcut for the given key and simulate\n * a click on the ref'ed element.\n */\nfunction useKeyboardShortcutRef<T extends HTMLElement>(\n  key: KeyboardShortcut\n): MutableRefObject<T | null> {\n  const el = useRef<T | null>(null);\n  const handler = useCallback(() => {\n    el.current?.click();\n  }, []);\n  useKeyboardShortcut(key, handler);\n  return el;\n}\n\nexport default function AdminLinkWithHotkey({\n  children,\n  shortcut,\n  ...linkProps\n}: RecordPathDetails & {\n  page: PageName;\n  children: ReactNode;\n  shortcut: KeyboardShortcut;\n}): JSX.Element {\n  const el = useKeyboardShortcutRef<HTMLAnchorElement>(shortcut);\n\n  return (\n    <AdminLink {...linkProps} title={getKey(shortcut)} ref={el}>\n      {children}\n    </AdminLink>\n  );\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport FindFiles from \"../dialogs/find-files/FindFiles\";\nimport Publish from \"../dialogs/Publish\";\nimport Refresh from \"../dialogs/Refresh\";\nimport { LektorEvents, subscribe, unsubscribe } from \"../events\";\n\ntype DialogDetails = LektorEvents[\"lektor-dialog\"];\n\ntype DialogState = (DialogDetails & { preventNavigation?: boolean }) | null;\n\nexport default function DialogSlot(): JSX.Element | null {\n  const [dialog, setDialog] = useState<DialogState>(null);\n\n  const dismiss = useCallback(\n    () => setDialog((c) => (c?.preventNavigation ? c : null)),\n    []\n  );\n  const prevent = useCallback(\n    (preventNavigation: boolean) =>\n      setDialog((d) => (d ? { ...d, preventNavigation } : null)),\n    []\n  );\n  useEffect(() => {\n    const handler = ({ detail }: CustomEvent<DialogDetails>) => {\n      // Only change dialog if there is no dialog yet.\n      setDialog((current) => current ?? detail);\n    };\n    subscribe(\"lektor-dialog\", handler);\n    return () => unsubscribe(\"lektor-dialog\", handler);\n  }, []);\n\n  if (!dialog) {\n    return null;\n  }\n  if (dialog.type === \"find-files\") {\n    return <FindFiles dismiss={dismiss} />;\n  } else if (dialog.type === \"refresh\") {\n    return <Refresh dismiss={dismiss} preventNavigation={prevent} />;\n  } else if (dialog.type === \"publish\") {\n    return <Publish dismiss={dismiss} preventNavigation={prevent} />;\n  }\n  const exhaustiveCheck: never = dialog.type;\n  throw new Error(exhaustiveCheck);\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport SlideDialog from \"./SlideDialog\";\nimport { trans, TranslationEntry } from \"../i18n\";\nimport { LektorEvents, subscribe, unsubscribe } from \"../events\";\n\n/**\n * Listen to events and show an error dialog (potentially on top of an open\n * dialog).\n */\nexport default function ErrorDialog(): JSX.Element | null {\n  const [error, setError] = useState<{ code: string } | null>(null);\n\n  const dismiss = useCallback(() => setError(null), []);\n\n  useEffect(() => {\n    const handler = ({ detail }: CustomEvent<LektorEvents[\"lektor-error\"]>) =>\n      setError(detail);\n    subscribe(\"lektor-error\", handler);\n    return () => unsubscribe(\"lektor-error\", handler);\n  }, []);\n\n  if (!error) {\n    return null;\n  }\n  return (\n    <SlideDialog\n      dismiss={dismiss}\n      hasCloseButton={false}\n      title={trans(\"ERROR\")}\n    >\n      <p>\n        {trans(\"ERROR_OCURRED\")}\n        {\": \"}\n        {trans((\"ERROR_\" + error.code) as TranslationEntry)}\n      </p>\n      <p>\n        <button type=\"button\" className=\"btn btn-primary\" onClick={dismiss}>\n          {trans(\"CLOSE\")}\n        </button>\n      </p>\n    </SlideDialog>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport { get } from \"../fetch\";\nimport { trans } from \"../i18n\";\n\ntype State = { serverIsUp: boolean; projectId: string | null };\n\nexport default function ServerStatus(): JSX.Element | null {\n  const [state, setState] = useState<State>({\n    serverIsUp: true,\n    projectId: null,\n  });\n\n  useEffect(() => {\n    const onInterval = () => {\n      get(\"/ping\", null).then(\n        ({ project_id }) => {\n          setState(({ projectId }) =>\n            projectId === null\n              ? { projectId: project_id, serverIsUp: true }\n              : { projectId, serverIsUp: projectId === project_id }\n          );\n        },\n        () => {\n          setState((s) => ({ ...s, serverIsUp: false }));\n        }\n      );\n    };\n    const id = window.setInterval(onInterval, 2000);\n    return () => window.clearInterval(id);\n  }, []);\n\n  if (state.serverIsUp) {\n    return null;\n  }\n  return (\n    <div className=\"interface-protector server-down-panel\">\n      <div className=\"server-down-dialog\">\n        <h3>{trans(\"ERROR_SERVER_UNAVAILABLE\")}</h3>\n        <p>{trans(\"ERROR_SERVER_UNAVAILABLE_MESSAGE\")}</p>\n      </div>\n    </div>\n  );\n}\n","import React, { ReactNode, useEffect } from \"react\";\nimport { trans } from \"../i18n\";\n\nexport default function SlideDialog({\n  title,\n  hasCloseButton,\n  dismiss,\n  children,\n}: {\n  title: string;\n  hasCloseButton: boolean;\n  dismiss: () => void;\n  children: ReactNode;\n}): JSX.Element {\n  useEffect(() => {\n    const handler = (ev: KeyboardEvent) => {\n      if (ev.key === \"Escape\") {\n        ev.preventDefault();\n        dismiss();\n      }\n    };\n    window.addEventListener(\"keydown\", handler);\n    return () => window.removeEventListener(\"keydown\", handler);\n  }, [dismiss]);\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n\n  return (\n    <div className=\"dialog-slot\">\n      <div className=\"container\">\n        <div className=\"sliding-panel col-md-6 offset-md-3\">\n          {hasCloseButton && (\n            <a\n              href=\"#\"\n              className=\"close-btn\"\n              onClick={(ev) => {\n                ev.preventDefault();\n                dismiss();\n              }}\n            >\n              {trans(\"CLOSE\")}\n            </a>\n          )}\n          <h3>{title}</h3>\n          {children}\n        </div>\n      </div>\n      <div className=\"interface-protector\" />\n    </div>\n  );\n}\n","import React, { MouseEvent, useCallback, useState } from \"react\";\n\nexport default function ToggleGroup({\n  className = \"\",\n  groupTitle,\n  children,\n}: {\n  className?: string;\n  groupTitle: string;\n  children: React.ReactNode;\n}) {\n  const [open, setOpen] = useState(false);\n\n  const toggle = useCallback((event: MouseEvent) => {\n    event.preventDefault();\n    setOpen((v) => !v);\n  }, []);\n\n  return (\n    <div\n      className={\n        open ? `${className} toggle-group` : `${className} toggle-group closed`\n      }\n    >\n      <h4 className=\"toggle-group-header\" onClick={toggle}>\n        {groupTitle}\n      </h4>\n      <div className=\"toggle-group-content\">{children}</div>\n    </div>\n  );\n}\n","import { useCallback } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { PageName } from \"../context/page-context\";\nimport { RecordAlternative, RecordPath } from \"../context/record-context\";\n\n/**\n * Compute an admin path.\n * @param page - e.g. edit or preview\n * @param path - fs path to the record\n * @param alt - the alternative to use.\n * @returns\n */\nexport function adminPath(\n  page: PageName,\n  path: RecordPath,\n  alt: RecordAlternative\n): string {\n  const params = new URLSearchParams({ path });\n  if (alt !== \"_primary\") {\n    params.set(\"alt\", alt);\n  }\n  return `${$LEKTOR_CONFIG.admin_root}/${page}?${params}`;\n}\n\n/**\n * Use a function to change the admin page.\n * @returns A function to navigate to an admin page for a given view\n *          and page fs path and alt.\n */\nexport function useGoToAdminPage() {\n  const history = useHistory();\n\n  return useCallback(\n    (name: PageName, path: RecordPath, alt: RecordAlternative) => {\n      history.push(adminPath(name, path, alt));\n    },\n    [history]\n  );\n}\n","import { createContext } from \"react\";\n\nexport const PAGE_NAMES = [\n  \"edit\",\n  \"delete\",\n  \"preview\",\n  \"add-child\",\n  \"upload\",\n] as const;\nexport type PageName = typeof PAGE_NAMES[number];\n\nexport function isPageName(p: unknown): p is PageName {\n  return PAGE_NAMES.includes(p as PageName);\n}\n\n/** The currently rendered page of the Lektor admin interface. */\nexport const PageContext = createContext<PageName>(\"edit\");\n","import { createContext, useContext } from \"react\";\n\n/** Path to a Lektor record. */\nexport type RecordPath = `/${string}`;\n/** Alternative of a Lektor record. */\nexport type RecordAlternative = string;\n\n/** Details about the path to a Lektor record. */\nexport type RecordPathDetails = {\n  /** Path of the current record (Lektor db path). */\n  path: RecordPath;\n  /** The alternative of the record. */\n  alt: RecordAlternative;\n};\n\nexport const RecordContext = createContext<RecordPathDetails>({\n  path: \"/\",\n  alt: \"_primary\",\n});\n\n/** The current record. */\nexport function useRecord(): RecordPathDetails {\n  return useContext(RecordContext);\n}\n\n/** The alternative of the currently active record. */\nexport function useRecordAlt(): string {\n  const record = useRecord();\n  return record.alt;\n}\n\n/** The path of the currently active record. */\nexport function useRecordPath(): RecordPath {\n  const record = useRecord();\n  return record.path;\n}\n","import React, {\n  ChangeEvent,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\n\nimport SlideDialog from \"../components/SlideDialog\";\nimport { apiUrl, get, post } from \"../fetch\";\nimport { trans, trans_fallback } from \"../i18n\";\nimport { showErrorDialog } from \"../error-dialog\";\n\nexport interface Server {\n  id: string;\n  short_target: string;\n  name: string;\n  name_i18n: Partial<Record<string, string>>;\n}\n\n/**\n * Render a <select for the available target servers.\n */\nfunction TargetServers({\n  activeTarget,\n  servers,\n  setActiveTarget,\n}: {\n  activeTarget: string;\n  servers: Server[];\n  setActiveTarget: (value: string) => void;\n}) {\n  function onChange(event: ChangeEvent<HTMLSelectElement>) {\n    setActiveTarget(event.target.value);\n  }\n  const serverOptions = servers.map((server) => (\n    <option value={server.id} key={server.id}>\n      {trans_fallback(server.name_i18n, server.name) +\n        \" (\" +\n        server.short_target +\n        \")\"}\n    </option>\n  ));\n\n  return (\n    <dl>\n      <dt>{trans(\"PUBLISH_SERVER\")}</dt>\n      <dd>\n        <div className=\"input-group\">\n          <select\n            value={activeTarget}\n            onChange={onChange}\n            className=\"form-control\"\n          >\n            {serverOptions}\n          </select>\n        </div>\n      </dd>\n    </dl>\n  );\n}\n\ntype PublishState = \"IDLE\" | \"BUILDING\" | \"PUBLISH\" | \"DONE\";\n\nfunction BuildLog({ log }: { log: string[] }) {\n  const buildLog = useRef<HTMLPreElement | null>(null);\n  useEffect(() => {\n    const node = buildLog.current;\n    if (node) {\n      node.scrollTop = node.scrollHeight;\n    }\n  }, [log]);\n  return (\n    <pre ref={buildLog} className=\"build-log\">\n      {log.join(\"\\n\")}\n    </pre>\n  );\n}\n\nfunction Publish({\n  dismiss,\n  preventNavigation,\n}: {\n  dismiss: () => void;\n  preventNavigation: (b: boolean) => void;\n}): JSX.Element {\n  const [servers, setServers] = useState<Server[]>([]);\n  const [activeTarget, setActiveTarget] = useState(\"\");\n  const [log, setLog] = useState<string[]>([]);\n  const [state, setState] = useState<PublishState>(\"IDLE\");\n\n  useEffect(() => {\n    get(\"/servers\", null).then(({ servers }) => {\n      setServers(servers);\n      setActiveTarget(servers.length ? servers[0].id : \"\");\n    }, showErrorDialog);\n  }, []);\n\n  const onPublish = useCallback(() => {\n    setLog([]);\n    setState(\"BUILDING\");\n    preventNavigation(true);\n    post(\"/build\", null).then(() => {\n      setState(\"PUBLISH\");\n\n      const eventSource = new EventSource(\n        apiUrl(\"/publish\", { server: activeTarget })\n      );\n      eventSource.addEventListener(\"message\", (event) => {\n        const data = JSON.parse(event.data);\n        if (data === null) {\n          setState(\"DONE\");\n          preventNavigation(false);\n          eventSource.close();\n        } else {\n          setLog((log) => log.concat(data.msg));\n        }\n      });\n    }, showErrorDialog);\n  }, [activeTarget, preventNavigation]);\n  const isSafeToPublish = state === \"IDLE\" || state === \"DONE\";\n\n  return (\n    <SlideDialog\n      dismiss={dismiss}\n      hasCloseButton={false}\n      title={trans(\"PUBLISH\")}\n    >\n      <p>{trans(\"PUBLISH_NOTE\")}</p>\n      <TargetServers\n        activeTarget={activeTarget}\n        servers={servers}\n        setActiveTarget={setActiveTarget}\n      />\n      <p>\n        <button\n          type=\"button\"\n          className=\"btn btn-primary\"\n          disabled={!isSafeToPublish}\n          onClick={onPublish}\n        >\n          {trans(\"PUBLISH\")}\n        </button>{\" \"}\n        <button\n          type=\"button\"\n          className=\"btn btn-secondary border\"\n          disabled={!isSafeToPublish}\n          onClick={dismiss}\n        >\n          {trans(state === \"DONE\" ? \"CLOSE\" : \"CANCEL\")}\n        </button>\n      </p>\n      {state !== \"IDLE\" ? (\n        <>\n          <h3>\n            {state !== \"DONE\"\n              ? trans(\"CURRENTLY_PUBLISHING\")\n              : trans(\"PUBLISH_DONE\")}\n          </h3>\n          <pre>{trans(\"STATE\") + \": \" + trans(`PUBLISH_STATE_${state}`)}</pre>\n          <BuildLog log={log} />\n        </>\n      ) : null}\n    </SlideDialog>\n  );\n}\n\nexport default Publish;\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport SlideDialog from \"../components/SlideDialog\";\nimport { post } from \"../fetch\";\nimport { trans } from \"../i18n\";\nimport { showErrorDialog } from \"../error-dialog\";\n\nexport default function Refresh({\n  dismiss,\n  preventNavigation,\n}: {\n  dismiss: () => void;\n  preventNavigation: (v: boolean) => void;\n}): JSX.Element {\n  const [state, setState] = useState<\"IDLE\" | \"DONE\" | \"CLEANING\">(\"IDLE\");\n  const isSafeToNavigate = state === \"IDLE\" || state === \"DONE\";\n\n  const refresh = useCallback(() => {\n    setState(\"CLEANING\");\n    post(\"/clean\", null).then(() => {\n      setState(\"DONE\");\n    }, showErrorDialog);\n  }, []);\n  useEffect(\n    () => preventNavigation(!isSafeToNavigate),\n    [preventNavigation, isSafeToNavigate]\n  );\n\n  return (\n    <SlideDialog\n      dismiss={dismiss}\n      hasCloseButton={false}\n      title={trans(\"REFRESH_BUILD\")}\n    >\n      <p>{trans(\"REFRESH_BUILD_NOTE\")}</p>\n      <p>\n        <button\n          type=\"button\"\n          className=\"btn btn-primary\"\n          disabled={!isSafeToNavigate}\n          onClick={refresh}\n        >\n          {trans(\"REFRESH_BUILD\")}\n        </button>{\" \"}\n        <button\n          type=\"button\"\n          className=\"btn btn-secondary border\"\n          disabled={!isSafeToNavigate}\n          onClick={dismiss}\n        >\n          {trans(state === \"DONE\" ? \"CLOSE\" : \"CANCEL\")}\n        </button>\n      </p>\n      {state !== \"IDLE\" && (\n        <div>\n          <h3>\n            {state !== \"DONE\"\n              ? trans(\"CURRENTLY_REFRESHING_BUILD\")\n              : trans(\"REFRESHING_BUILD_DONE\")}\n          </h3>\n        </div>\n      )}\n    </SlideDialog>\n  );\n}\n","import React, {\n  KeyboardEvent,\n  useCallback,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\n\nimport { RecordPath, useRecordAlt } from \"../../context/record-context\";\nimport SlideDialog from \"../../components/SlideDialog\";\nimport { post } from \"../../fetch\";\nimport { getCurrentLanguge, trans } from \"../../i18n\";\nimport { showErrorDialog } from \"../../error-dialog\";\nimport ResultRow from \"./ResultRow\";\nimport { useGoToAdminPage } from \"../../components/use-go-to-admin-page\";\nimport { PageContext } from \"../../context/page-context\";\n\nexport type SearchResult = {\n  parents: { title: string }[];\n  path: RecordPath;\n  title: string;\n};\n\nfunction FindFiles({ dismiss }: { dismiss: () => void }): JSX.Element {\n  const alt = useRecordAlt();\n  const page = useContext(PageContext);\n\n  const [query, setQuery] = useState(\"\");\n  const [results, setResults] = useState<SearchResult[]>([]);\n  const [selected, setSelected] = useState(-1);\n\n  const goToAdminPage = useGoToAdminPage();\n\n  const target = page === \"preview\" ? \"preview\" : \"edit\";\n\n  useEffect(() => {\n    if (!query) {\n      setResults([]);\n      setSelected(-1);\n      return;\n    }\n    let ignore = false;\n\n    post(\"/find\", { q: query, alt, lang: getCurrentLanguge() }).then(\n      ({ results }) => {\n        if (!ignore) {\n          setResults(results);\n          setSelected((selected) => Math.min(selected, results.length - 1));\n        }\n      },\n      showErrorDialog\n    );\n    return () => {\n      ignore = true;\n    };\n  }, [alt, query]);\n\n  const onInputKey = useCallback(\n    (event: KeyboardEvent) => {\n      if (event.key === \"ArrowDown\") {\n        event.preventDefault();\n        setSelected((selected) => (selected + 1) % results.length);\n      } else if (event.key === \"ArrowUp\") {\n        event.preventDefault();\n        setSelected(\n          (selected) => (selected - 1 + results.length) % results.length\n        );\n      } else if (event.key === \"Enter\") {\n        const item = results[selected];\n        if (item) {\n          dismiss();\n          goToAdminPage(target, item.path, alt);\n        }\n      }\n    },\n    [alt, dismiss, goToAdminPage, results, selected, target]\n  );\n\n  return (\n    <SlideDialog dismiss={dismiss} hasCloseButton title={trans(\"FIND_FILES\")}>\n      <input\n        type=\"text\"\n        autoFocus\n        className=\"form-control\"\n        value={query}\n        onChange={(ev) => setQuery(ev.target.value)}\n        onKeyDown={onInputKey}\n        placeholder={trans(\"FIND_FILES_PLACEHOLDER\")}\n      />\n      <ul className=\"search-results\">\n        {results.map((result, idx) => (\n          <ResultRow\n            key={result.path}\n            result={result}\n            isActive={idx === selected}\n            dismiss={dismiss}\n            alt={alt}\n            target={target}\n          />\n        ))}\n      </ul>\n    </SlideDialog>\n  );\n}\n\nexport default FindFiles;\n","import React from \"react\";\nimport AdminLink from \"../../components/AdminLink\";\nimport { PageName } from \"../../context/page-context\";\nimport { RecordAlternative } from \"../../context/record-context\";\nimport { SearchResult } from \"./FindFiles\";\n\n/**\n * A page in the result list in the find files dialog.\n */\nexport default function ResultRow({\n  result,\n  isActive,\n  dismiss,\n  alt,\n  target,\n}: {\n  result: SearchResult;\n  isActive: boolean;\n  dismiss: () => void;\n  alt: RecordAlternative;\n  target: PageName;\n}): JSX.Element {\n  return (\n    <li className={isActive ? \"active\" : \"\"}>\n      <AdminLink page={target} path={result.path} alt={alt} onClick={dismiss}>\n        {result.parents.map((item) => (\n          <span key={item.title}>{item.title}</span>\n        ))}\n        <strong>{result.title}</strong>\n      </AdminLink>\n    </li>\n  );\n}\n","import { dispatch } from \"./events\";\nimport { FetchError } from \"./fetch\";\n\nexport function showErrorDialog(error: unknown): void {\n  if (error instanceof FetchError) {\n    dispatch(\"lektor-error\", error);\n  } else {\n    console.error(\"unknown error:\", error);\n  }\n}\n","export type LektorEvents = {\n  \"lektor-attachments-changed\": string;\n  \"lektor-dialog\": { type: \"find-files\" | \"refresh\" | \"publish\" };\n  \"lektor-error\": { code: string };\n};\n\n/** Dispatch one of the custom events. */\nexport function dispatch<T extends keyof LektorEvents>(\n  type: T,\n  detail: LektorEvents[T]\n): void {\n  document.dispatchEvent(new CustomEvent(type, { detail }));\n}\n\n/** Subscribe to one of Lektor's custom events. */\nexport function subscribe<T extends keyof LektorEvents>(\n  type: T,\n  handler: (ev: CustomEvent<LektorEvents[T]>) => void\n): void {\n  document.addEventListener(type, handler as EventListener);\n}\n\n/** Subscribe from one of Lektor's custom events. */\nexport function unsubscribe<T extends keyof LektorEvents>(\n  type: T,\n  handler: (ev: CustomEvent<LektorEvents[T]>) => void\n): void {\n  document.removeEventListener(type, handler as EventListener);\n}\n","import { RecordInfo } from \"./components/types\";\nimport {\n  RecordAlternative,\n  RecordPath,\n  RecordPathDetails,\n} from \"./context/record-context\";\nimport { SearchResult } from \"./dialogs/find-files/FindFiles\";\nimport { Server } from \"./dialogs/Publish\";\nimport { RecordPathInfoSegment } from \"./header/BreadCrumbs\";\nimport { NewRecordInfo } from \"./views/add-child-page/types\";\nimport { RawRecord } from \"./views/edit/EditPage\";\n\nexport class FetchError extends Error {\n  constructor(readonly code: string) {\n    super();\n  }\n}\n\n/**\n * Handle a JSON response - throw on HTTP error.\n */\nfunction handleJSON(response: Response) {\n  if (!response.ok) {\n    throw new FetchError(\"REQUEST_FAILED\");\n  }\n  return response.json();\n}\n\nconst credentials = \"same-origin\";\nconst headers = { \"Content-Type\": \"application/json\" };\n\n/**\n * Helper to execute one of the fetch requests to the Lektor admin API.\n */\nfunction fetchJSON(\n  input: string,\n  method: \"GET\" | \"POST\" | \"PUT\",\n  json?: unknown\n): Promise<unknown> {\n  const init: RequestInit =\n    json === undefined\n      ? { credentials, method }\n      : { credentials, method, headers, body: JSON.stringify(json) };\n  return fetch(input, init).then(handleJSON);\n}\n\n/** Required URL parameters for GET API endpoints. */\ntype GetAPIParams = {\n  \"/matchurl\": { url_path: string };\n  \"/newattachment\": { path: RecordPath };\n  \"/newrecord\": { path: RecordPath; alt?: RecordAlternative };\n  \"/pathinfo\": { path: RecordPath };\n  \"/ping\": null;\n  \"/previewinfo\": RecordPathDetails;\n  \"/rawrecord\": RecordPathDetails;\n  \"/recordinfo\": { path: RecordPath };\n  \"/servers\": null;\n};\n\n/** Type of the returned JSON for GET API endpoints. */\ntype GetAPIReturns = {\n  \"/matchurl\": RecordPathDetails & { exists: boolean };\n  \"/newattachment\": { label: string; can_upload: boolean };\n  \"/newrecord\": NewRecordInfo;\n  \"/pathinfo\": { segments: RecordPathInfoSegment[] };\n  \"/ping\": { project_id: string };\n  \"/previewinfo\": { url: string | null };\n  \"/rawrecord\": RawRecord;\n  \"/recordinfo\": RecordInfo;\n  \"/servers\": { servers: Server[] };\n};\n\n/**\n * Required URL parameters for POST API endpoints.\n * Currently one endpoint (newrecord) has the data sent as JSON which isn't typed yet.\n */\ntype PostAPIParams = {\n  \"/browsefs\": RecordPathDetails;\n  \"/build\": null;\n  \"/clean\": null;\n  \"/deleterecord\": RecordPathDetails & { delete_master: \"1\" | \"0\" };\n  \"/find\": { q: string; alt: RecordAlternative; lang: string };\n  \"/newrecord\": null; // it's all in the JSON request.\n};\n\n/** Type of the returned JSON for POST API endpoints. `unknown` in case that it isn't used */\ntype PostAPIReturns = {\n  \"/browsefs\": { okay: boolean };\n  \"/build\": unknown;\n  \"/clean\": unknown;\n  \"/deleterecord\": unknown;\n  \"/find\": { results: SearchResult[] };\n  \"/newrecord\": { valid_id: boolean; exists: boolean; path: RecordPath };\n};\n\n/**\n * Required JSON data for PUT API endpoints.\n */\ntype PutAPIData = {\n  \"/rawrecord\": RecordPathDetails & { data: Record<string, string | null> };\n};\n\n/** Type of the returned JSON for PUT API endpoints. `unknown` in case that it isn't used */\ntype PutAPIReturns = {\n  \"/rawrecord\": unknown;\n};\n\n/**\n * URL to one of Lektor's API endpoints with query string.\n * @param endpoint - the API endpoint\n * @param params - possible URL parameters to include in the query string\n * @returns the absolute API URL with query string.\n */\nexport function apiUrl(\n  endpoint: string,\n  params?: Record<string, string> | null\n): string {\n  const url = `${$LEKTOR_CONFIG.admin_root}/api${endpoint}`;\n  if (params) {\n    const urlParams = new URLSearchParams();\n    Object.entries(params).forEach(([key, value]) => {\n      urlParams.set(key, value);\n    });\n    return `${url}?${urlParams.toString()}`;\n  }\n  return url;\n}\n\n/**\n * Load data from the JSON API.\n * @param endpoint - The API endpoint to get.\n * @param params - URL params to set.\n * @param json - Possible JSON body of the request.\n */\nexport function get<T extends keyof GetAPIReturns>(\n  endpoint: T,\n  params: GetAPIParams[T]\n): Promise<GetAPIReturns[T]> {\n  const url = apiUrl(endpoint, params);\n  return fetchJSON(url, \"GET\") as Promise<GetAPIReturns[T]>;\n}\n\n/**\n * Execute a POST api request.\n * @param endpoint - The API endpoint to POST to.\n * @param params - URL params to set.\n * @param json - Possible JSON body of the request.\n */\nexport function post<T extends keyof PostAPIReturns>(\n  endpoint: T,\n  params: PostAPIParams[T],\n  json?: unknown\n): Promise<PostAPIReturns[T]> {\n  const url = apiUrl(endpoint, params);\n  return fetchJSON(url, \"POST\", json) as Promise<PostAPIReturns[T]>;\n}\n\n/**\n * Execute a PUT api request.\n * @param endpoint - The API endpoint to PUT to.\n * @param json - Possible JSON body of the request.\n */\nexport function put<T extends keyof PutAPIReturns>(\n  endpoint: T,\n  json: PutAPIData[T]\n): Promise<PutAPIReturns[T]> {\n  const url = apiUrl(endpoint);\n  return fetchJSON(url, \"PUT\", json);\n}\n","import React, { useContext, useEffect, useState } from \"react\";\nimport { useRecord } from \"../context/record-context\";\nimport { get } from \"../fetch\";\nimport { trans, trans_fallback } from \"../i18n\";\nimport { showErrorDialog } from \"../error-dialog\";\nimport AdminLink from \"../components/AdminLink\";\nimport { RecordAlternative, RecordPath } from \"../context/record-context\";\nimport { PageContext } from \"../context/page-context\";\n\nexport interface RecordPathInfoSegment {\n  id: string;\n  path: RecordPath;\n  label: string;\n  label_i18n?: Record<string, string>;\n  exists: boolean;\n  can_have_children: boolean;\n}\n\nfunction Crumb({\n  alt,\n  item,\n  targetPage,\n}: {\n  alt: RecordAlternative;\n  item: RecordPathInfoSegment;\n  targetPage: \"preview\" | \"edit\";\n}) {\n  const { path, exists } = item;\n  const label = exists ? trans_fallback(item.label_i18n, item.label) : item.id;\n  const className = exists\n    ? \"breadcrumb-item\"\n    : \"breadcrumb-item missing-record-crumb\";\n  return (\n    <li className={className}>\n      <AdminLink page={targetPage} path={path} alt={alt}>\n        {label}\n      </AdminLink>\n    </li>\n  );\n}\n\nfunction AddNewPage({\n  alt,\n  item,\n}: {\n  alt: RecordAlternative;\n  item: RecordPathInfoSegment;\n}) {\n  return item.can_have_children ? (\n    <li className=\"new-record-crumb\">\n      <AdminLink page={\"add-child\"} path={item.path} alt={alt}>\n        +\n      </AdminLink>\n    </li>\n  ) : null;\n}\n\nfunction BreadCrumbs(): JSX.Element {\n  const page = useContext(PageContext);\n  const { path, alt } = useRecord();\n\n  const [segments, setSegments] = useState<RecordPathInfoSegment[] | null>(\n    null\n  );\n\n  useEffect(() => {\n    let ignore = false;\n\n    get(\"/pathinfo\", { path }).then((resp) => {\n      if (!ignore) {\n        setSegments(resp.segments);\n      }\n    }, showErrorDialog);\n\n    return () => {\n      ignore = true;\n    };\n  }, [path]);\n\n  if (!segments) {\n    return (\n      <ul className=\"breadcrumb\">\n        <li>\n          <AdminLink page=\"edit\" path=\"/\" alt=\"_primary\">\n            {trans(\"BACK_TO_OVERVIEW\")}\n          </AdminLink>\n        </li>\n      </ul>\n    );\n  }\n\n  const target = page === \"preview\" ? \"preview\" : \"edit\";\n  const lastItem = segments[segments.length - 1];\n\n  return (\n    <ul className=\"breadcrumb\">\n      {segments.map((item) => (\n        <Crumb key={item.path} item={item} alt={alt} targetPage={target} />\n      ))}\n      <AddNewPage item={lastItem} alt={alt} />\n    </ul>\n  );\n}\n\nexport default BreadCrumbs;\n","import React, { useCallback, useEffect } from \"react\";\nimport { useRecord } from \"../context/record-context\";\nimport { getCanonicalUrl, keyboardShortcutHandler } from \"../utils\";\nimport { get } from \"../fetch\";\nimport { trans } from \"../i18n\";\nimport { showErrorDialog } from \"../error-dialog\";\nimport { dispatch } from \"../events\";\n\nconst findFiles = () => dispatch(\"lektor-dialog\", { type: \"find-files\" });\nconst refresh = () => dispatch(\"lektor-dialog\", { type: \"refresh\" });\nconst publish = () => dispatch(\"lektor-dialog\", { type: \"publish\" });\n\nconst onKeyPress = keyboardShortcutHandler(\n  { key: \"Control+g\", mac: \"Meta+g\", preventDefault: true },\n  findFiles\n);\n\nexport default function GlobalActions(): JSX.Element {\n  const record = useRecord();\n\n  useEffect(() => {\n    window.addEventListener(\"keydown\", onKeyPress);\n    return () => window.removeEventListener(\"keydown\", onKeyPress);\n  }, []);\n\n  const returnToWebsite = useCallback(() => {\n    get(\"/previewinfo\", record).then(({ url }) => {\n      window.location.href =\n        url === null ? getCanonicalUrl(\"/\") : getCanonicalUrl(url);\n    }, showErrorDialog);\n  }, [record]);\n\n  return (\n    <div className=\"btn-group\">\n      <button\n        type=\"button\"\n        className=\"btn btn-secondary border\"\n        onClick={findFiles}\n        title={trans(\"FIND_FILES\")}\n      >\n        <i className=\"fa fa-search fa-fw\" />\n      </button>\n      <button\n        type=\"button\"\n        className=\"btn btn-secondary border\"\n        onClick={publish}\n        title={trans(\"PUBLISH\")}\n      >\n        <i className=\"fa fa-cloud-upload fa-fw\" />\n      </button>\n      <button\n        type=\"button\"\n        className=\"btn btn-secondary border\"\n        onClick={refresh}\n        title={trans(\"REFRESH_BUILD\")}\n      >\n        <i className=\"fa fa-refresh fa-fw\" />\n      </button>\n      <button\n        type=\"button\"\n        className=\"btn btn-secondary border\"\n        onClick={returnToWebsite}\n        title={trans(\"RETURN_TO_WEBSITE\")}\n      >\n        <i className=\"fa fa-eye fa-fw\" />\n      </button>\n    </div>\n  );\n}\n","import React from \"react\";\n\nimport BreadCrumbs from \"./BreadCrumbs\";\nimport GlobalActions from \"./GlobalActions\";\n\nexport default function Header({\n  sidebarIsActive,\n  toggleSidebar,\n}: {\n  sidebarIsActive: boolean;\n  toggleSidebar: () => void;\n}): JSX.Element {\n  return (\n    <header>\n      <div className=\"container\">\n        <button\n          type=\"button\"\n          className={\n            sidebarIsActive\n              ? \"fa fa-bars navbar-toggle active\"\n              : \"fa fa-bars navbar-toggle\"\n          }\n          onClick={toggleSidebar}\n          aria-label=\"Toggle navigation\"\n        />\n        <div className=\"d-flex justify-content-between\">\n          <BreadCrumbs />\n          <div>\n            <GlobalActions />\n          </div>\n        </div>\n      </div>\n    </header>\n  );\n}\n","import ca from \"../../lektor/translations/ca.json\";\nimport de from \"../../lektor/translations/de.json\";\nimport en from \"../../lektor/translations/en.json\";\nimport es from \"../../lektor/translations/es.json\";\nimport fr from \"../../lektor/translations/fr.json\";\nimport it from \"../../lektor/translations/it.json\";\nimport ja from \"../../lektor/translations/ja.json\";\nimport ko from \"../../lektor/translations/ko.json\";\nimport nl from \"../../lektor/translations/nl.json\";\nimport pl from \"../../lektor/translations/pl.json\";\nimport pt from \"../../lektor/translations/pt.json\";\nimport ru from \"../../lektor/translations/ru.json\";\nimport zh from \"../../lektor/translations/zh.json\";\n\ntype LektorTranslations = typeof en;\nexport type TranslationEntry = keyof LektorTranslations;\n\nexport const translations: Record<string, Partial<LektorTranslations>> = {\n  ca,\n  de,\n  en,\n  es,\n  fr,\n  it,\n  ja,\n  ko,\n  nl,\n  pl,\n  pt,\n  ru,\n  zh,\n};\n\nlet currentLanguage = \"en\";\nlet currentTranslations = translations[currentLanguage] ?? {};\n\nexport function setCurrentLanguage(lang: string): void {\n  currentLanguage = lang;\n  currentTranslations = translations[currentLanguage];\n}\n\nexport function getCurrentLanguge(): string {\n  return currentLanguage;\n}\n\nexport type Translatable = Partial<Record<string, string>>;\n\n/**\n * Get translation for a key.\n * @param key - The translation key.\n */\nexport function trans(key: TranslationEntry): string {\n  return currentTranslations[key] ?? key;\n}\n\n/**\n * Get translation from an object of translations\n * @param translation_object - The object containing translations.\n */\nexport function trans_obj(translation_object: Translatable): string {\n  return translation_object[currentLanguage] ?? translation_object.en ?? \"\";\n}\n\n/**\n * Get translation for a key with a fallback.\n * @param translation_object - The translation key\n * @param fallback - A fallback to use if the translation is missing.\n */\nexport function trans_fallback(\n  translation_object: Translatable | undefined,\n  fallback: string\n): string {\n  if (!translation_object) {\n    return fallback;\n  }\n  return trans_obj(translation_object) || fallback;\n}\n\n/**\n * Get translation for a key with a `%s` replacement.\n * @param key - The translation key\n * @param replacement - replacement for `%s`.\n */\nexport function trans_format(\n  key: TranslationEntry,\n  replacement: string\n): string {\n  const translation = trans(key);\n  return translation.replace(\"%s\", replacement);\n}\n","import React, { useMemo } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {\n  BrowserRouter,\n  Redirect,\n  useLocation,\n  useRouteMatch,\n} from \"react-router-dom\";\nimport { setCurrentLanguage } from \"./i18n\";\nimport { RecordContext, RecordPathDetails } from \"./context/record-context\";\n\nimport App from \"./views/App\";\nimport { adminPath } from \"./components/use-go-to-admin-page\";\n\nimport \"font-awesome/css/font-awesome.css\";\nimport \"../scss/main.scss\";\nimport { PageContext, PageName, isPageName } from \"./context/page-context\";\nimport { trimSlashes } from \"./utils\";\n\nfunction Page({ page }: { page: PageName }) {\n  const { search } = useLocation();\n  const record = useMemo((): RecordPathDetails => {\n    const params = new URLSearchParams(search);\n    return {\n      path: `/${trimSlashes(params.get(\"path\") ?? \"/\")}`,\n      alt: params.get(\"alt\") ?? \"_primary\",\n    };\n  }, [search]);\n\n  return (\n    <PageContext.Provider value={page}>\n      <RecordContext.Provider value={record}>\n        <App />\n      </RecordContext.Provider>\n    </PageContext.Provider>\n  );\n}\n\nfunction Main() {\n  const root = $LEKTOR_CONFIG.admin_root;\n  const page = useRouteMatch<{ page: string }>(`${root}/:page`)?.params.page;\n  if (!isPageName(page)) {\n    return <Redirect to={adminPath(\"edit\", \"/\", \"_primary\")} />;\n  }\n  return <Page page={page} />;\n}\n\nconst dash = document.getElementById(\"dash\");\nif (dash) {\n  setCurrentLanguage($LEKTOR_CONFIG.lang);\n  ReactDOM.render(\n    <BrowserRouter>\n      <Main />\n    </BrowserRouter>,\n    dash\n  );\n}\n","import React, { memo, useContext } from \"react\";\nimport { Alternative } from \"../components/types\";\nimport { trans, trans_obj } from \"../i18n\";\nimport AdminLink from \"../components/AdminLink\";\nimport { PageContext } from \"../context/page-context\";\nimport { useRecordPath } from \"../context/record-context\";\n\nfunction Alternatives({ alts }: { alts: Alternative[] }) {\n  const page = useContext(PageContext);\n  const path = useRecordPath();\n\n  if (alts.length < 2) {\n    return null;\n  }\n\n  const items = alts.map((item) => {\n    let title = trans_obj(item.name_i18n);\n    if (item.is_primary) {\n      title += ` (${trans(\"PRIMARY_ALT\")})`;\n    } else if (item.primary_overlay) {\n      title += ` (${trans(\"PRIMARY_OVERLAY\")})`;\n    }\n    const className = item.exists ? \"alt\" : \"alt alt-missing\";\n\n    return (\n      <li key={item.alt} className={className}>\n        <AdminLink page={page as \"edit\"} path={path} alt={item.alt}>\n          {title}\n        </AdminLink>\n      </li>\n    );\n  });\n\n  return (\n    <>\n      <h3>{trans(\"ALTS\")}</h3>\n      <ul className=\"nav\">{items}</ul>\n    </>\n  );\n}\n\nexport default memo(Alternatives);\n","import React, { memo } from \"react\";\nimport AdminLink from \"../components/AdminLink\";\nimport { useRecordAlt } from \"../context/record-context\";\nimport { RecordInfo } from \"../components/types\";\nimport { trans } from \"../i18n\";\n\nfunction AttachmentActions({ recordInfo }: { recordInfo: RecordInfo }) {\n  const alt = useRecordAlt();\n  const attachments = recordInfo.attachments;\n  return (\n    <>\n      <h3>{trans(\"ATTACHMENTS\")}</h3>\n      <ul className=\"nav\">\n        {attachments.length > 0 ? (\n          attachments.map((atch) => {\n            return (\n              <li key={atch.id}>\n                <AdminLink page=\"edit\" path={atch.path} alt={alt}>\n                  {atch.id} ({atch.type})\n                </AdminLink>\n              </li>\n            );\n          })\n        ) : (\n          <li key=\"_missing\">\n            <em>{trans(\"NO_ATTACHMENTS\")}</em>\n          </li>\n        )}\n      </ul>\n    </>\n  );\n}\n\nexport default memo(AttachmentActions);\n","import React from \"react\";\nimport { trans, trans_obj } from \"../i18n\";\nimport { useRecordAlt } from \"../context/record-context\";\nimport { RecordChild } from \"../components/types\";\nimport ChildPagination from \"./ChildPagination\";\nimport { CHILDREN_PER_PAGE } from \"./constants\";\nimport AdminLink from \"../components/AdminLink\";\n\nexport default function ChildActions({\n  targetPage,\n  allChildren,\n  page,\n  setPage,\n}: {\n  targetPage: \"preview\" | \"edit\";\n  allChildren: RecordChild[];\n  page: number;\n  setPage: (n: number) => void;\n}): JSX.Element {\n  const alt = useRecordAlt();\n\n  const shownChildren = allChildren.slice(\n    (page - 1) * CHILDREN_PER_PAGE,\n    page * CHILDREN_PER_PAGE\n  );\n\n  return (\n    <>\n      <h3>{trans(\"CHILD_PAGES\")}</h3>\n      <ul className=\"nav\">\n        <ChildPagination\n          numberOfChildren={allChildren.length}\n          page={page}\n          setPage={setPage}\n        />\n        {shownChildren.length > 0 ? (\n          shownChildren.map((child) => (\n            <li key={child.id}>\n              <AdminLink page={targetPage} path={child.path} alt={alt}>\n                {trans_obj(child.label_i18n)}\n              </AdminLink>\n            </li>\n          ))\n        ) : (\n          <li key=\"_missing\">\n            <em>{trans(\"NO_CHILD_PAGES\")}</em>\n          </li>\n        )}\n      </ul>\n    </>\n  );\n}\n","import React from \"react\";\nimport { CHILDREN_PER_PAGE } from \"./constants\";\n\n/** Pagination buttons for the list of children in the sidebar. */\nexport default function ChildPagination({\n  page,\n  numberOfChildren,\n  setPage,\n}: {\n  page: number;\n  numberOfChildren: number;\n  setPage: (n: number) => void;\n}): JSX.Element | null {\n  const pages = Math.ceil(numberOfChildren / CHILDREN_PER_PAGE);\n  if (pages <= 1) {\n    return null;\n  }\n  return (\n    <li className=\"pagination\">\n      {page > 1 ? (\n        <a\n          href=\"#\"\n          onClick={(ev) => {\n            ev.preventDefault();\n            setPage(page - 1);\n          }}\n        >\n          \n        </a>\n      ) : (\n        <em></em>\n      )}\n      <span className=\"page\">{page + \" / \" + pages}</span>\n      {page < pages ? (\n        <a\n          href=\"#\"\n          onClick={(ev) => {\n            ev.preventDefault();\n            setPage(page + 1);\n          }}\n        >\n          \n        </a>\n      ) : (\n        <em></em>\n      )}\n    </li>\n  );\n}\n","import React, { MouseEvent, memo, useCallback } from \"react\";\nimport { useRecord } from \"../context/record-context\";\nimport { RecordInfo } from \"../components/types\";\nimport { trans } from \"../i18n\";\nimport { getPlatform } from \"../utils\";\nimport { post } from \"../fetch\";\nimport { showErrorDialog } from \"../error-dialog\";\nimport AdminLinkWithHotkey from \"../components/AdminLinkWithHotkey\";\nimport AdminLink from \"../components/AdminLink\";\n\nconst getBrowseButtonTitle = () => {\n  const platform = getPlatform();\n  if (platform === \"mac\") {\n    return trans(\"BROWSE_FS_MAC\");\n  } else if (platform === \"windows\") {\n    return trans(\"BROWSE_FS_WINDOWS\");\n  } else {\n    return trans(\"BROWSE_FS\");\n  }\n};\n\nfunction BrowseFSLink() {\n  const record = useRecord();\n  const fsOpen = useCallback(\n    (ev: MouseEvent) => {\n      ev.preventDefault();\n      post(\"/browsefs\", record).then(({ okay }) => {\n        if (!okay) {\n          alert(trans(\"ERROR_CANNOT_BROWSE_FS\"));\n        }\n      }, showErrorDialog);\n    },\n    [record]\n  );\n  return (\n    <a href=\"#\" onClick={fsOpen}>\n      {getBrowseButtonTitle()}\n    </a>\n  );\n}\n\nconst editKey = { key: \"Control+e\", mac: \"Meta+e\", preventDefault: true };\n\nfunction PageActions({ recordInfo }: { recordInfo: RecordInfo }) {\n  const { path, alt } = useRecord();\n\n  return (\n    <>\n      <h3>\n        {recordInfo.is_attachment\n          ? trans(\"ATTACHMENT_ACTIONS\")\n          : trans(\"PAGE_ACTIONS\")}\n      </h3>\n      <ul className=\"nav\">\n        <li key=\"edit\">\n          <AdminLinkWithHotkey\n            page=\"edit\"\n            path={path}\n            alt={alt}\n            shortcut={editKey}\n          >\n            {recordInfo.is_attachment ? trans(\"EDIT_METADATA\") : trans(\"EDIT\")}\n          </AdminLinkWithHotkey>\n        </li>\n        {recordInfo.can_be_deleted && (\n          <li key=\"delete\">\n            <AdminLink page=\"delete\" path={path} alt={alt}>\n              {trans(\"DELETE\")}\n            </AdminLink>\n          </li>\n        )}\n        <li key=\"preview\">\n          <AdminLink page=\"preview\" path={path} alt={alt}>\n            {trans(\"PREVIEW\")}\n          </AdminLink>\n        </li>\n        {recordInfo.exists && (\n          <li key=\"fs-open\">\n            <BrowseFSLink />\n          </li>\n        )}\n        {recordInfo.can_have_children && (\n          <li key=\"add-child\">\n            <AdminLink page=\"add-child\" path={path} alt={alt}>\n              {trans(\"ADD_CHILD_PAGE\")}\n            </AdminLink>\n          </li>\n        )}\n        {recordInfo.can_have_attachments && (\n          <li key=\"add-attachment\">\n            <AdminLink page=\"upload\" path={path} alt={alt}>\n              {trans(\"ADD_ATTACHMENT\")}\n            </AdminLink>\n          </li>\n        )}\n      </ul>\n    </>\n  );\n}\n\nexport default memo(PageActions);\n","import React, { useContext, useEffect, useReducer, useState } from \"react\";\nimport { get } from \"../fetch\";\nimport { trans_obj } from \"../i18n\";\nimport { showErrorDialog } from \"../error-dialog\";\nimport { Alternative, RecordInfo } from \"../components/types\";\nimport PageActions from \"./PageActions\";\nimport Alternatives from \"./Alternatives\";\nimport AttachmentActions from \"./AttachmentActions\";\nimport { CHILDREN_PER_PAGE } from \"./constants\";\nimport ChildActions from \"./ChildActions\";\nimport { subscribe, unsubscribe } from \"../events\";\nimport { PageContext } from \"../context/page-context\";\nimport { useRecordPath } from \"../context/record-context\";\n\n/**\n * Keep a cache of the page number in the list of subpages that we are currently\n * on. Only keeps this page number in memory for the last five records.\n */\nexport class ChildPosCache {\n  private memo: [record: string, page: number][];\n\n  constructor() {\n    this.memo = [];\n  }\n\n  /** Remember the page for a record. */\n  rememberPosition(record: string, page: number): void {\n    // remove current value\n    this.memo = this.memo.filter(([r]) => r !== record);\n    this.memo.unshift([record, page]);\n    if (this.memo.length > 5) {\n      this.memo.length = 5;\n    }\n  }\n\n  getPosition(record: string, childCount: number): number {\n    const page = this.memo.find(([r]) => r === record)?.[1];\n    return page ? Math.min(page, Math.ceil(childCount / CHILDREN_PER_PAGE)) : 1;\n  }\n}\n\nconst compareAlternatives = (a: Alternative, b: Alternative) => {\n  const nameA = (a.is_primary ? \"A\" : \"B\") + trans_obj(a.name_i18n);\n  const nameB = (b.is_primary ? \"A\" : \"B\") + trans_obj(b.name_i18n);\n  return nameA === nameB ? 0 : nameA < nameB ? -1 : 1;\n};\n\nfunction Sidebar(): JSX.Element | null {\n  const page = useContext(PageContext);\n  const path = useRecordPath();\n\n  const [recordInfo, setRecordInfo] = useState<RecordInfo | null>(null);\n  const [childrenPage, setChildrenPage] = useState(1);\n  const [childPosCache] = useState(() => new ChildPosCache());\n  const [updateForced, forceUpdate] = useReducer((x) => x + 1, 0);\n\n  useEffect(() => {\n    const handler = ({ detail }: CustomEvent<string>) => {\n      if (detail === path) {\n        forceUpdate();\n      }\n    };\n    subscribe(\"lektor-attachments-changed\", handler);\n    return () => unsubscribe(\"lektor-attachments-changed\", handler);\n  }, [path]);\n\n  useEffect(() => {\n    let ignore = false;\n\n    get(\"/recordinfo\", { path }).then((resp) => {\n      if (!ignore) {\n        setRecordInfo({ ...resp, alts: resp.alts.sort(compareAlternatives) });\n        setChildrenPage(childPosCache.getPosition(path, resp.children.length));\n      }\n    }, showErrorDialog);\n\n    return () => {\n      ignore = true;\n    };\n  }, [path, childPosCache, updateForced]);\n\n  if (!recordInfo) {\n    return null;\n  }\n\n  return (\n    <>\n      <PageActions recordInfo={recordInfo} />\n      <Alternatives alts={recordInfo.alts} />\n      {recordInfo.can_have_children && (\n        <ChildActions\n          targetPage={page === \"preview\" ? \"preview\" : \"edit\"}\n          allChildren={recordInfo.children}\n          page={childrenPage}\n          setPage={(page) => {\n            childPosCache.rememberPosition(path, page);\n            setChildrenPage(page);\n          }}\n        />\n      )}\n      {recordInfo.can_have_attachments && (\n        <AttachmentActions recordInfo={recordInfo} />\n      )}\n    </>\n  );\n}\n\nexport default Sidebar;\n","/** The number of children to show in the sidebar. */\nexport const CHILDREN_PER_PAGE = 15;\n","// https://code.djangoproject.com/browser/django/trunk/django/contrib/admin/media/js/urlify.js\nconst charmap: Record<string, string> = {\n  // latin\n  : \"A\",\n  : \"A\",\n  : \"A\",\n  : \"A\",\n  : \"Ae\",\n  : \"A\",\n  : \"AE\",\n  : \"C\",\n  : \"E\",\n  : \"E\",\n  : \"E\",\n  : \"E\",\n  : \"I\",\n  : \"I\",\n  : \"I\",\n  : \"I\",\n  : \"D\",\n  : \"N\",\n  : \"O\",\n  : \"O\",\n  : \"O\",\n  : \"O\",\n  : \"Oe\",\n  : \"O\",\n  : \"O\",\n  : \"U\",\n  : \"U\",\n  : \"U\",\n  : \"Ue\",\n  : \"U\",\n  : \"Y\",\n  : \"TH\",\n  : \"ss\",\n  : \"a\",\n  : \"a\",\n  : \"a\",\n  : \"a\",\n  : \"ae\",\n  : \"a\",\n  : \"ae\",\n  : \"c\",\n  : \"e\",\n  : \"e\",\n  : \"e\",\n  : \"e\",\n  : \"i\",\n  : \"i\",\n  : \"i\",\n  : \"i\",\n  : \"d\",\n  : \"n\",\n  : \"o\",\n  : \"o\",\n  : \"o\",\n  : \"o\",\n  : \"oe\",\n  : \"o\",\n  : \"o\",\n  : \"u\",\n  : \"u\",\n  : \"u\",\n  : \"ue\",\n  : \"u\",\n  : \"y\",\n  : \"th\",\n  : \"y\",\n  : \"SS\",\n  // greek\n  : \"a\",\n  : \"b\",\n  : \"g\",\n  : \"d\",\n  : \"e\",\n  : \"z\",\n  : \"h\",\n  : \"8\",\n  : \"i\",\n  : \"k\",\n  : \"l\",\n  : \"m\",\n  : \"n\",\n  : \"3\",\n  : \"o\",\n  : \"p\",\n  : \"r\",\n  : \"s\",\n  : \"t\",\n  : \"y\",\n  : \"f\",\n  : \"x\",\n  : \"ps\",\n  : \"w\",\n  : \"a\",\n  : \"e\",\n  : \"i\",\n  : \"o\",\n  : \"y\",\n  : \"h\",\n  : \"w\",\n  : \"s\",\n  : \"i\",\n  : \"y\",\n  : \"y\",\n  : \"i\",\n  : \"A\",\n  : \"B\",\n  : \"G\",\n  : \"D\",\n  : \"E\",\n  : \"Z\",\n  : \"H\",\n  : \"8\",\n  : \"I\",\n  : \"K\",\n  : \"L\",\n  : \"M\",\n  : \"N\",\n  : \"3\",\n  : \"O\",\n  : \"P\",\n  : \"R\",\n  : \"S\",\n  : \"T\",\n  : \"Y\",\n  : \"F\",\n  : \"X\",\n  : \"PS\",\n  : \"W\",\n  : \"A\",\n  : \"E\",\n  : \"I\",\n  : \"O\",\n  : \"Y\",\n  : \"H\",\n  : \"W\",\n  : \"I\",\n  : \"Y\",\n  // turkish\n  : \"s\",\n  : \"S\",\n  : \"i\",\n  : \"I\",\n  : \"g\",\n  : \"G\",\n  // russian\n  : \"a\",\n  : \"b\",\n  : \"v\",\n  : \"g\",\n  : \"d\",\n  : \"e\",\n  : \"yo\",\n  : \"zh\",\n  : \"z\",\n  : \"i\",\n  : \"j\",\n  : \"k\",\n  : \"l\",\n  : \"m\",\n  : \"n\",\n  : \"o\",\n  : \"p\",\n  : \"r\",\n  : \"s\",\n  : \"t\",\n  : \"u\",\n  : \"f\",\n  : \"h\",\n  : \"c\",\n  : \"ch\",\n  : \"sh\",\n  : \"sh\",\n  : \"u\",\n  : \"y\",\n  : \"\",\n  : \"e\",\n  : \"yu\",\n  : \"ya\",\n  : \"A\",\n  : \"B\",\n  : \"V\",\n  : \"G\",\n  : \"D\",\n  : \"E\",\n  : \"Yo\",\n  : \"Zh\",\n  : \"Z\",\n  : \"I\",\n  : \"J\",\n  : \"K\",\n  : \"L\",\n  : \"M\",\n  : \"N\",\n  : \"O\",\n  : \"P\",\n  : \"R\",\n  : \"S\",\n  : \"T\",\n  : \"U\",\n  : \"F\",\n  : \"H\",\n  : \"C\",\n  : \"Ch\",\n  : \"Sh\",\n  : \"Sh\",\n  : \"U\",\n  : \"Y\",\n  : \"\",\n  : \"E\",\n  : \"Yu\",\n  : \"Ya\",\n  // ukranian\n  : \"Ye\",\n  : \"I\",\n  : \"Yi\",\n  : \"G\",\n  : \"ye\",\n  : \"i\",\n  : \"yi\",\n  : \"g\",\n  // czech\n  : \"c\",\n  : \"d\",\n  : \"e\",\n  : \"n\",\n  : \"r\",\n  : \"s\",\n  : \"t\",\n  : \"u\",\n  : \"z\",\n  : \"C\",\n  : \"D\",\n  : \"E\",\n  : \"N\",\n  : \"R\",\n  : \"S\",\n  : \"T\",\n  : \"U\",\n  : \"Z\",\n  // polish\n  : \"a\",\n  : \"c\",\n  : \"e\",\n  : \"l\",\n  : \"n\",\n  : \"s\",\n  : \"z\",\n  : \"z\",\n  : \"A\",\n  : \"C\",\n  : \"E\",\n  : \"L\",\n  : \"N\",\n  : \"S\",\n  : \"Z\",\n  : \"Z\",\n  // latvian\n  : \"a\",\n  : \"e\",\n  : \"g\",\n  : \"i\",\n  : \"k\",\n  : \"l\",\n  : \"n\",\n  : \"u\",\n  : \"A\",\n  : \"E\",\n  : \"G\",\n  : \"I\",\n  : \"K\",\n  : \"L\",\n  : \"N\",\n  : \"U\",\n  // lithuanian\n  : \"e\",\n  : \"i\",\n  : \"u\",\n  : \"E\",\n  : \"I\",\n  : \"U\",\n  // romanian\n  : \"t\",\n  : \"T\",\n  : \"t\",\n  : \"T\",\n  : \"s\",\n  : \"S\",\n  : \"a\",\n  : \"A\",\n  // currency\n  \"\": \"euro\",\n  \"\": \"cruzeiro\",\n  \"\": \"french franc\",\n  \"\": \"pound\",\n  \"\": \"lira\",\n  \"\": \"mill\",\n  \"\": \"naira\",\n  \"\": \"peseta\",\n  \"\": \"rupee\",\n  \"\": \"won\",\n  \"\": \"new shequel\",\n  \"\": \"dong\",\n  \"\": \"kip\",\n  \"\": \"tugrik\",\n  \"\": \"drachma\",\n  \"\": \"penny\",\n  \"\": \"peso\",\n  \"\": \"guarani\",\n  \"\": \"austral\",\n  \"\": \"hryvnia\",\n  \"\": \"cedi\",\n  \"\": \"cent\",\n  \"\": \"yen\",\n  : \"yuan\",\n  : \"yen\",\n  \"\": \"rial\",\n  \"\": \"ecu\",\n  \"\": \"currency\",\n  \"\": \"baht\",\n  $: \"dollar\",\n  \"\": \"indian rupee\",\n  // symbols\n  \"\": \"(c)\",\n  : \"oe\",\n  : \"OE\",\n  \"\": \"sum\",\n  \"\": \"(r)\",\n  \"\": \"+\",\n  \"\": '\"',\n  \"\": '\"',\n  \"\": \"'\",\n  \"\": \"'\",\n  \"\": \"d\",\n  : \"f\",\n  \"\": \"tm\",\n  \"\": \"sm\",\n  \"\": \"...\",\n  \"\": \"o\",\n  : \"o\",\n  : \"a\",\n  \"\": \"*\",\n  \"\": \"delta\",\n  \"\": \"infinity\",\n  \"\": \"love\",\n  \"&\": \"and\",\n  \"|\": \"or\",\n  \"<\": \"less\",\n  \">\": \"greater\",\n  \"=\": \"equals\",\n};\n\nconst multicharmap: Record<string, string> = {\n  \"<3\": \"love\",\n  \"&&\": \"and\",\n  \"||\": \"or\",\n  \"w/\": \"with\",\n};\n\ninterface SlugifyOptions {\n  replacement: string;\n  remove: string | RegExp;\n  charmap: Record<string, string>;\n  multicharmap: Record<string, string>;\n}\n\nconst pretty: SlugifyOptions = {\n  replacement: \"-\",\n  remove: /[.]/g,\n  charmap,\n  multicharmap,\n};\n\nexport function slugify(rawString: string): string {\n  const string = rawString.toString();\n  const opts = pretty;\n  const lengths: number[] = [];\n  Object.keys(opts.multicharmap).forEach((key) => {\n    const len = key.length;\n    if (!lengths.includes(len)) {\n      lengths.push(len);\n    }\n  });\n  let result = \"\";\n  for (let char, i = 0, l = string.length; i < l; i++) {\n    char = string[i];\n    if (\n      !lengths.some((len) => {\n        const str = string.substr(i, len);\n        if (opts.multicharmap[str]) {\n          i += len - 1;\n          char = opts.multicharmap[str];\n          return true;\n        } else {\n          return false;\n        }\n      })\n    ) {\n      if (opts.charmap[char]) {\n        char = opts.charmap[char];\n      }\n    }\n    char = char.replace(/[^\\w\\s\\-._~]/g, \"\"); // allowed\n    if (opts.remove) {\n      // add flavour:\n      char = char.replace(opts.remove, \"\");\n    }\n    result += char;\n  }\n\n  // trim leading/trailing spaces:\n  result = result.replace(/^\\s+|\\s+$/g, \"\");\n  // convert spaces:\n  result = result.replace(/[-\\s]+/g, opts.replacement);\n  // remove trailing separator:\n  return result.replace(opts.replacement + \"$\", \"\");\n}\n","import React from \"react\";\nimport { trans_obj, Translatable } from \"./i18n\";\n\n/**\n * Formats a user label appropriately\n */\nexport function formatUserLabel(\n  inputConfig: Translatable | string\n): JSX.Element {\n  const label =\n    typeof inputConfig === \"string\" ? inputConfig : trans_obj(inputConfig);\n\n  if (!label) {\n    return <span />;\n  }\n\n  const iconData = label.match(/^\\[\\[\\s*(.*?)\\s*(;\\s*(.*?))?\\s*\\]\\]$/);\n  if (iconData) {\n    let className = \"fa fa-\" + iconData[1];\n    if ((iconData[3] || \"\").match(/90|180|270/)) {\n      className += \" fa-rotate-\" + iconData[3];\n    }\n    return <i className={className} />;\n  }\n\n  return <span>{label}</span>;\n}\n","import { RecordPath } from \"./context/record-context\";\n\nexport function isValidUrl(url: string): boolean {\n  return !!url.match(/^([a-z0-9+.-]+):(\\/\\/)?[^/]\\S+$/);\n}\n\n/**\n * Trim leading slashes from a string.\n */\nexport function trimLeadingSlashes(string: string): string {\n  const match = /^\\/*(.*?)$/.exec(string);\n  return match ? match[1] : \"\";\n}\n\n/**\n * Trim trailing slashes from a string.\n */\nexport function trimTrailingSlashes(string: string): string {\n  const match = /^(.*?)\\/*$/.exec(string);\n  return match ? match[1] : \"\";\n}\n\n/**\n * Trim both leading and trailing slashes from a string.\n */\nexport function trimSlashes(string: string): string {\n  const match = /^\\/*(.*?)\\/*$/.exec(string);\n  return match ? match[1] : \"\";\n}\n\n/**\n * Trim both leading and trailing colons from a string.\n */\nexport function trimColons(string: string): string {\n  const match = /^:*(.*?):*$/.exec(string);\n  return match ? match[1] : \"\";\n}\n\nexport function getCanonicalUrl(localPath: string): string {\n  const base = trimTrailingSlashes($LEKTOR_CONFIG.site_root);\n  return `${base}/${trimLeadingSlashes(localPath)}`;\n}\n\nexport function getPlatform(): \"windows\" | \"mac\" | \"linux\" | \"other\" {\n  if (navigator.appVersion.indexOf(\"Win\") !== -1) {\n    return \"windows\";\n  } else if (navigator.appVersion.indexOf(\"Mac\") !== -1) {\n    return \"mac\";\n  } else if (\n    navigator.appVersion.indexOf(\"X11\") !== -1 ||\n    navigator.appVersion.indexOf(\"Linux\") !== -1\n  ) {\n    return \"linux\";\n  }\n  return \"other\";\n}\n\nexport interface KeyboardShortcut {\n  key: string;\n  mac?: string;\n  preventDefault?: boolean;\n}\n\nexport function getKey(shortcut: KeyboardShortcut): string {\n  return getPlatform() === \"mac\" && shortcut.mac ? shortcut.mac : shortcut.key;\n}\n\nexport function keyboardShortcutHandler(\n  shortcut: KeyboardShortcut,\n  action: (ev: KeyboardEvent) => void\n): (ev: KeyboardEvent) => void {\n  const key = getKey(shortcut);\n  return (ev) => {\n    let eventKey = ev.key;\n    if (ev.altKey) {\n      eventKey = `Alt+${eventKey}`;\n    }\n    if (ev.ctrlKey) {\n      eventKey = `Control+${eventKey}`;\n    }\n    if (ev.metaKey) {\n      eventKey = `Meta+${eventKey}`;\n    }\n    if (eventKey === key) {\n      if (shortcut.preventDefault) {\n        ev.preventDefault();\n      }\n      action(ev);\n    }\n  };\n}\n\nexport function getParentPath(path: RecordPath): RecordPath | null {\n  const match = /^(\\/.*)\\/[^/]*$/.exec(path);\n  return match ? (match[1] as RecordPath) : null;\n}\n","import React, {\n  ChangeEvent,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport { useRecordPath } from \"../context/record-context\";\nimport { apiUrl, get } from \"../fetch\";\nimport { trans, trans_format } from \"../i18n\";\nimport { showErrorDialog } from \"../error-dialog\";\nimport { dispatch } from \"../events\";\n\ntype NewAttachmentInfo = {\n  label: string;\n  can_upload: boolean;\n};\n\nfunction AddAttachmentPage(): JSX.Element | null {\n  const path = useRecordPath();\n  const [newAttachmentInfo, setNewAttachmentInfo] =\n    useState<NewAttachmentInfo | null>(null);\n  const fileInput = useRef<HTMLInputElement | null>(null);\n  const [currentFiles, setCurrentFiles] = useState<File[]>([]);\n  const [isUploading, setIsUploading] = useState(false);\n  const [currentProgress, setCurrentProgress] = useState(0);\n\n  useEffect(() => {\n    let ignore = false;\n\n    get(\"/newattachment\", { path }).then((resp) => {\n      if (!ignore) {\n        setNewAttachmentInfo(resp);\n      }\n    }, showErrorDialog);\n    return () => {\n      ignore = true;\n    };\n  }, [path]);\n\n  const onFileSelected = useCallback(\n    ({ target }: ChangeEvent<HTMLInputElement>) => {\n      if (isUploading || !target.files) {\n        return;\n      }\n\n      const files = Array.prototype.slice.call(target.files, 0);\n      setCurrentFiles(files);\n      setIsUploading(true);\n\n      const formData = new FormData();\n      formData.append(\"path\", path);\n      files.forEach((file) => {\n        formData.append(\"file\", file, file.name);\n      });\n\n      const xhr = new XMLHttpRequest();\n      xhr.open(\"POST\", apiUrl(\"/newattachment\"));\n      xhr.onprogress = (event) => {\n        setCurrentProgress(Math.round((event.loaded * 100) / event.total));\n      };\n      xhr.onload = () => {\n        setIsUploading(false);\n        setCurrentProgress(100);\n        dispatch(\"lektor-attachments-changed\", path);\n      };\n      xhr.send(formData);\n    },\n    [path, isUploading]\n  );\n\n  if (!newAttachmentInfo) {\n    return null;\n  }\n\n  return (\n    <>\n      <h2>{trans_format(\"ADD_ATTACHMENT_TO\", newAttachmentInfo.label)}</h2>\n      <p>{trans(\"ADD_ATTACHMENT_NOTE\")}</p>\n      <ul>\n        {currentFiles.map((file) => (\n          <li key={file.name}>\n            {file.name} ({file.type})\n          </li>\n        ))}\n      </ul>\n      <p>\n        {trans(\"PROGRESS\")}: {currentProgress}%\n      </p>\n      <input\n        type=\"file\"\n        ref={fileInput}\n        multiple\n        style={{ display: \"none\" }}\n        onChange={onFileSelected}\n      />\n      <div className=\"actions\">\n        <button\n          type=\"button\"\n          className=\"btn btn-primary\"\n          onClick={() => fileInput.current?.click()}\n        >\n          {trans(\"UPLOAD\")}\n        </button>\n      </div>\n    </>\n  );\n}\n\nexport default AddAttachmentPage;\n","import React, { useContext, useReducer } from \"react\";\n\nimport Header from \"../header/Header\";\nimport Sidebar from \"../sidebar/Sidebar\";\nimport DialogSlot from \"../components/DialogSlot\";\nimport ServerStatus from \"../components/ServerStatus\";\nimport ErrorDialog from \"../components/ErrorDialog\";\n\nimport EditPage from \"./edit/EditPage\";\nimport DeletePage from \"./delete/DeletePage\";\nimport PreviewPage from \"./PreviewPage\";\nimport AddChildPage from \"./add-child-page/AddChildPage\";\nimport AddAttachmentPage from \"./AddAttachmentPage\";\nimport { PageContext } from \"../context/page-context\";\n\nconst mainComponentForPage = {\n  edit: EditPage,\n  delete: DeletePage,\n  preview: PreviewPage,\n  \"add-child\": AddChildPage,\n  upload: AddAttachmentPage,\n} as const;\n\nexport default function App() {\n  const page = useContext(PageContext);\n\n  const [sidebarIsActive, toggleSidebar] = useReducer((v) => !v, false);\n  const MainComponent = mainComponentForPage[page];\n  return (\n    <>\n      <Header sidebarIsActive={sidebarIsActive} toggleSidebar={toggleSidebar} />\n      <ErrorDialog />\n      <DialogSlot />\n      <div className=\"container\">\n        <div\n          className={\n            sidebarIsActive\n              ? \"block-offcanvas row active\"\n              : \"block-offcanvas row\"\n          }\n        >\n          <nav className=\"sidebar col-md-2 col-sm-3\">\n            <Sidebar />\n          </nav>\n          <div className=\"main col-md-10 col-sm-9\">\n            <MainComponent />\n          </div>\n        </div>\n      </div>\n      <ServerStatus />\n    </>\n  );\n}\n","import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport { trimLeadingSlashes, trimTrailingSlashes } from \"../utils\";\nimport { get } from \"../fetch\";\nimport { useRecord } from \"../context/record-context\";\nimport { showErrorDialog } from \"../error-dialog\";\nimport { useGoToAdminPage } from \"../components/use-go-to-admin-page\";\n\nfunction getSiteRootUrl() {\n  const site_root = `/${trimLeadingSlashes($LEKTOR_CONFIG.site_root)}`;\n  const absRootUrl = new URL(site_root, document.baseURI).href;\n  return trimTrailingSlashes(absRootUrl);\n}\n\nfunction usePreviewUrl(siteRootUrl: string): string {\n  const { path, alt } = useRecord();\n  const [previewUrl, setPreviewUrl] = useState<string>(\"about:blank\");\n\n  useEffect(() => {\n    let ignore = false;\n    get(\"/previewinfo\", { path, alt }).then(({ url }) => {\n      if (!ignore) {\n        setPreviewUrl(url ? siteRootUrl + url : \"about:blank\");\n      }\n    }, showErrorDialog);\n\n    return () => {\n      ignore = true;\n    };\n  }, [path, alt, siteRootUrl]);\n\n  return previewUrl;\n}\n\nexport default function PreviewPage(): JSX.Element {\n  const siteRootUrl = useMemo(getSiteRootUrl, []);\n  const previewUrl = usePreviewUrl(siteRootUrl);\n  const iframe = useRef<HTMLIFrameElement | null>(null);\n  const goToAdminPage = useGoToAdminPage();\n\n  useEffect(() => {\n    const location = iframe.current?.contentWindow?.location;\n    if (location && location.href !== previewUrl) {\n      location.replace(previewUrl);\n    }\n  }, [previewUrl]);\n\n  const onLoad = useCallback(() => {\n    const contentWindow = iframe.current?.contentWindow;\n    if (contentWindow) {\n      // Note that cross-origin security restrictions prevent us\n      // from being able to inspect or manipulate pages from\n      // other origins, so this will only work when the iframe is\n      // previewing one of our pages.\n      try {\n        // Pass keydown events on to parent window\n        // This is an attempt to ensure that hotkeys like Ctl-e work\n        // even when the iframe has the focus.\n        contentWindow.addEventListener(\"keydown\", (ev: KeyboardEvent) => {\n          const clone = new KeyboardEvent(ev.type, ev);\n          window.dispatchEvent(clone) || ev.preventDefault();\n        });\n\n        const href = contentWindow.location?.href;\n        if (href && href !== previewUrl) {\n          // Iframe has been navigated to a new page (e.g. user clicked link)\n          if (href.startsWith(`${siteRootUrl}/`)) {\n            // Attempt to move Admin UI to new page\n            const url_path = href.substring(siteRootUrl.length);\n            get(\"/matchurl\", { url_path }).then(({ exists, alt, path }) => {\n              if (exists) {\n                goToAdminPage(\"preview\", path, alt);\n              }\n            }, showErrorDialog);\n          }\n        }\n      } catch (e) {\n        if (e instanceof DOMException && e.name === \"SecurityError\") {\n          // Ignore exceptions having to do with cross-origin restrictions\n        } else {\n          throw e;\n        }\n      }\n    }\n  }, [goToAdminPage, previewUrl, siteRootUrl]);\n\n  return <iframe className=\"preview\" ref={iframe} onLoad={onLoad} />;\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { useRecord } from \"../../context/record-context\";\nimport { trans, trans_format } from \"../../i18n\";\nimport { get, post } from \"../../fetch\";\nimport { slugify } from \"../../slugify\";\nimport { showErrorDialog } from \"../../error-dialog\";\nimport { NewRecordInfo } from \"./types\";\nimport AvailableModels from \"./AvailableModels\";\nimport PrimaryField from \"./PrimaryFieldRow\";\nimport Slug from \"./Slug\";\nimport { useGoToAdminPage } from \"../../components/use-go-to-admin-page\";\n\n/** Show an alert with the given error message. */\nconst alertErr = (text: string) => {\n  alert(trans(\"ERROR_PREFIX\") + text);\n};\n\nfunction AddChildPage(): JSX.Element | null {\n  const { path, alt } = useRecord();\n\n  const [newChildInfo, setNewChildInfo] = useState<NewRecordInfo | null>(null);\n  const [selectedModel, setSelectedModel] = useState<string>(\"\");\n  const [id, setId] = useState<string>(\"\");\n  const [primary, setPrimary] = useState<string>(\"\");\n\n  useEffect(() => {\n    let ignore = false;\n    get(\"/newrecord\", { path }).then((resp) => {\n      if (!ignore) {\n        const defaultModel = resp.available_models.page\n          ? \"page\"\n          : Object.keys(resp.available_models).sort()[0];\n        const selectedModel = resp.implied_model ?? defaultModel;\n        setNewChildInfo(resp);\n        setId(\"\");\n        setPrimary(\"\");\n        setSelectedModel(selectedModel);\n      }\n    }, showErrorDialog);\n\n    return () => {\n      ignore = true;\n    };\n  }, [path]);\n\n  const primaryField =\n    newChildInfo?.available_models[selectedModel]?.primary_field;\n\n  const goToAdminPage = useGoToAdminPage();\n\n  const createRecord = useCallback(() => {\n    const currentId = id || slugify(primary).toLowerCase();\n    if (!currentId) {\n      alertErr(trans(\"ERROR_NO_ID_PROVIDED\"));\n      return;\n    }\n\n    const data: Record<string, string> = {};\n    if (!newChildInfo?.implied_model) {\n      data._model = selectedModel;\n    }\n    if (primaryField) {\n      data[primaryField.name] = primary;\n    }\n\n    post(\"/newrecord\", null, { id: currentId, path, data }).then(\n      ({ exists, valid_id, path }) => {\n        if (exists) {\n          alertErr(trans_format(\"ERROR_PAGE_ID_DUPLICATE\", currentId));\n        } else if (!valid_id) {\n          alertErr(trans_format(\"ERROR_INVALID_ID\", currentId));\n        } else {\n          goToAdminPage(\"edit\", path, alt);\n        }\n      },\n      showErrorDialog\n    );\n  }, [\n    alt,\n    goToAdminPage,\n    newChildInfo,\n    id,\n    path,\n    primary,\n    primaryField,\n    selectedModel,\n  ]);\n\n  if (!newChildInfo) {\n    return null;\n  }\n\n  return (\n    <>\n      <h2>{trans_format(\"ADD_CHILD_PAGE_TO\", newChildInfo.label)}</h2>\n      <p>{trans(\"ADD_CHILD_PAGE_NOTE\")}</p>\n      {!newChildInfo.implied_model && (\n        <AvailableModels\n          newChildInfo={newChildInfo}\n          selected={selectedModel}\n          setSelected={setSelectedModel}\n        />\n      )}\n      {primaryField && (\n        <PrimaryField\n          primary={primary}\n          setPrimary={setPrimary}\n          field={primaryField}\n        />\n      )}\n      <Slug\n        id={id}\n        placeholder={slugify(primary).toLowerCase()}\n        setId={setId}\n      />\n      <div className=\"actions\">\n        <button\n          type=\"button\"\n          className=\"btn btn-primary\"\n          onClick={createRecord}\n        >\n          {trans(\"CREATE_CHILD_PAGE\")}\n        </button>\n      </div>\n    </>\n  );\n}\n\nexport default AddChildPage;\n","import React from \"react\";\nimport { trans, trans_obj } from \"../../i18n\";\nimport { NewRecordInfo } from \"./types\";\n\n/**\n * A field to select one of the available models for the new child page.\n */\nexport default function AvailableModels({\n  newChildInfo,\n  selected,\n  setSelected,\n}: {\n  newChildInfo: NewRecordInfo;\n  selected: string;\n  setSelected: (s: string) => void;\n}): JSX.Element {\n  const available = Object.values(newChildInfo.available_models).sort((a, b) =>\n    a.name.toLowerCase().localeCompare(b.name.toLowerCase())\n  );\n\n  return (\n    <div className=\"row field-row\">\n      <div className=\"col-md-12\">\n        <dl className=\"field\">\n          <dt>{trans(\"MODEL\")}</dt>\n          <dd>\n            <select\n              value={selected}\n              className=\"form-control\"\n              onChange={(event) => setSelected(event.target.value)}\n            >\n              {available.map((model) => (\n                <option value={model.id} key={model.id}>\n                  {trans_obj(model.name_i18n)}\n                </option>\n              ))}\n            </select>\n          </dd>\n        </dl>\n      </div>\n    </div>\n  );\n}\n","import React, { SetStateAction } from \"react\";\nimport { formatUserLabel } from \"../../userLabel\";\nimport { getWidgetComponentWithFallback } from \"../../widgets\";\nimport { Field } from \"../../widgets/types\";\n\n/**\n * The input to change the primary field value for the new child page.\n */\nexport default function PrimaryField({\n  primary,\n  field,\n  setPrimary,\n}: {\n  primary: string;\n  setPrimary: (s: SetStateAction<string>) => void;\n  field: Field;\n}): JSX.Element {\n  const Widget = getWidgetComponentWithFallback(field.type);\n  const value = Widget.deserializeValue\n    ? Widget.deserializeValue(primary, field.type)\n    : primary;\n\n  return (\n    <div className=\"row field-row\">\n      <div className=\"col-md-12\">\n        <dl className=\"field\">\n          <dt>{formatUserLabel(field.label_i18n)}</dt>\n          <dd>\n            <Widget\n              value={value}\n              onChange={setPrimary}\n              type={field.type}\n              field={field}\n            />\n          </dd>\n        </dl>\n      </div>\n    </div>\n  );\n}\n","import React, { SetStateAction } from \"react\";\nimport { trans } from \"../../i18n\";\nimport { formatUserLabel } from \"../../userLabel\";\nimport { SlugInputWidget } from \"../../widgets/SlugInputWidget\";\n\n/**\n * Slug for the new child page.\n */\nexport default function Slug({\n  id,\n  placeholder,\n  setId,\n}: {\n  id: string;\n  placeholder: string;\n  setId: (s: SetStateAction<string>) => void;\n}): JSX.Element {\n  return (\n    <div className=\"row field-row\">\n      <div className=\"col-md-12\">\n        <dl className=\"field\">\n          <dt>{formatUserLabel(trans(\"ID\"))}</dt>\n          <dd>\n            <SlugInputWidget\n              value={id}\n              placeholder={placeholder}\n              onChange={setId}\n              type={{ widget: \"slug\", name: \"slug\", size: \"normal\" }}\n            />\n          </dd>\n        </dl>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { trans, trans_obj } from \"../../i18n\";\nimport { RecordInfo } from \"../../components/types\";\n\nexport default function DeletableAlternatives({\n  recordInfo,\n}: {\n  recordInfo: RecordInfo;\n}): JSX.Element {\n  return (\n    <div>\n      <h4>{trans(\"ALTS_TO_BE_DELETED\")}</h4>\n      <ul>\n        {recordInfo.alts\n          .filter((i) => i.exists)\n          .map((item) => {\n            let title = trans_obj(item.name_i18n);\n            if (item.is_primary) {\n              title += \" (\" + trans(\"PRIMARY_ALT\") + \")\";\n            } else if (item.primary_overlay) {\n              title += \" (\" + trans(\"PRIMARY_OVERLAY\") + \")\";\n            }\n            return <li key={item.alt}>{title}</li>;\n          })}\n      </ul>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { trans } from \"../../i18n\";\nimport { RecordInfo } from \"../../components/types\";\n\nexport default function DeletableAttachments({\n  recordInfo,\n}: {\n  recordInfo: RecordInfo;\n}): JSX.Element {\n  return (\n    <div>\n      <h4>{trans(\"ATTACHMENTS_TO_BE_DELETED\")}</h4>\n      <ul>\n        {recordInfo.attachments.map((atch) => (\n          <li key={atch.id}>\n            {atch.id} ({atch.type})\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { trans, trans_obj } from \"../../i18n\";\nimport { RecordInfo } from \"../../components/types\";\n\nexport default function DeletableChildPages({\n  recordInfo,\n}: {\n  recordInfo: RecordInfo;\n}): JSX.Element {\n  return (\n    <div>\n      <h4>{trans(\"CHILD_PAGES_TO_BE_DELETED\")}</h4>\n      <ul>\n        {recordInfo.children.map((child) => (\n          <li key={child.id}>{trans_obj(child.label_i18n)}</li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { trans } from \"../../i18n\";\n\nexport default function DeleteAllAltsChoice({\n  deleteMasterRecord,\n  setDeleteMasterRecord,\n  isAttachment,\n}: {\n  deleteMasterRecord: boolean;\n  setDeleteMasterRecord: (v: boolean) => void;\n  isAttachment: boolean;\n}): JSX.Element {\n  return (\n    <>\n      <p>{trans(\"DELETE_PRIMARY_ALT_INFO\")}</p>\n      <ul>\n        <li>\n          <label>\n            <input\n              type=\"radio\"\n              checked={deleteMasterRecord}\n              onChange={() => setDeleteMasterRecord(true)}\n            />{\" \"}\n            {trans(\n              isAttachment\n                ? \"DELETE_ALL_ATTACHMENT_ALTS\"\n                : \"DELETE_ALL_PAGE_ALTS\"\n            )}\n          </label>\n        </li>\n        <li>\n          <label>\n            <input\n              type=\"radio\"\n              checked={!deleteMasterRecord}\n              onChange={() => setDeleteMasterRecord(false)}\n            />{\" \"}\n            {trans(\n              isAttachment\n                ? \"DELETE_ONLY_PRIMARY_ATTACHMENT_ALT\"\n                : \"DELETE_ONLY_PRIMARY_PAGE_ALT\"\n            )}\n          </label>\n        </li>\n      </ul>\n    </>\n  );\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { useRecord } from \"../../context/record-context\";\nimport { getParentPath } from \"../../utils\";\nimport { get, post } from \"../../fetch\";\nimport { showErrorDialog } from \"../../error-dialog\";\nimport { RecordInfo } from \"../../components/types\";\nimport DeletableAttachments from \"./DeletableAttachments\";\nimport DeletableChildPages from \"./DeletableChildPages\";\nimport DeletableAlternatives from \"./DeletableAlternatives\";\nimport DeletePageActions from \"./DeletePageActions\";\nimport DeleteAllAltsChoice from \"./DeleteAllAltsChoice\";\nimport DeletePageHeader from \"./DeletePageHeader\";\nimport { dispatch } from \"../../events\";\nimport { useGoToAdminPage } from \"../../components/use-go-to-admin-page\";\n\nfunction DeletePage(): JSX.Element | null {\n  const { path, alt } = useRecord();\n\n  const [recordInfo, setRecordInfo] = useState<RecordInfo | null>(null);\n  const [deleteMasterRecord, setDeleteMasterRecord] = useState(true);\n\n  const goToAdminPage = useGoToAdminPage();\n\n  useEffect(() => {\n    let ignore = false;\n\n    get(\"/recordinfo\", { path }).then((resp) => {\n      if (!ignore) {\n        setRecordInfo(resp);\n      }\n    }, showErrorDialog);\n\n    return () => {\n      ignore = true;\n    };\n  }, [path]);\n\n  useEffect(() => {\n    setDeleteMasterRecord(alt === \"_primary\");\n  }, [alt]);\n\n  const deleteRecord = useCallback(() => {\n    const parent = getParentPath(path);\n    const targetPath = parent === null ? \"/\" : parent;\n\n    post(\"/deleterecord\", {\n      path,\n      alt,\n      delete_master: deleteMasterRecord ? \"1\" : \"0\",\n    }).then(() => {\n      if (recordInfo?.is_attachment) {\n        dispatch(\"lektor-attachments-changed\", parent ?? \"\");\n      }\n      goToAdminPage(\"edit\", targetPath, alt);\n    }, showErrorDialog);\n  }, [alt, path, deleteMasterRecord, goToAdminPage, recordInfo]);\n\n  const cancelDelete = useCallback(() => {\n    goToAdminPage(\"edit\", path, alt);\n  }, [goToAdminPage, path, alt]);\n\n  if (!recordInfo || !recordInfo.can_be_deleted) {\n    return null;\n  }\n\n  const hasAlts = recordInfo.alts.filter((a) => a.exists).length > 1;\n\n  return (\n    <div>\n      <DeletePageHeader recordInfo={recordInfo} currentAlt={alt} />\n      {hasAlts && alt === \"_primary\" && (\n        <DeleteAllAltsChoice\n          deleteMasterRecord={deleteMasterRecord}\n          setDeleteMasterRecord={setDeleteMasterRecord}\n          isAttachment={recordInfo.is_attachment}\n        />\n      )}\n      {deleteMasterRecord && (\n        <>\n          {hasAlts && alt === \"_primary\" && (\n            <DeletableAlternatives recordInfo={recordInfo} />\n          )}\n          {recordInfo.children.length > 0 && (\n            <DeletableChildPages recordInfo={recordInfo} />\n          )}\n          {recordInfo.attachments.length > 0 && (\n            <DeletableAttachments recordInfo={recordInfo} />\n          )}\n        </>\n      )}\n      <DeletePageActions\n        deleteRecord={deleteRecord}\n        cancelDelete={cancelDelete}\n      />\n    </div>\n  );\n}\n\nexport default DeletePage;\n","import React from \"react\";\nimport { trans } from \"../../i18n\";\n\nexport default function DeletePageActions({\n  deleteRecord,\n  cancelDelete,\n}: {\n  deleteRecord: () => void;\n  cancelDelete: () => void;\n}): JSX.Element {\n  return (\n    <div className=\"actions\">\n      <button type=\"button\" className=\"btn btn-primary\" onClick={deleteRecord}>\n        {trans(\"YES_DELETE\")}\n      </button>\n      <button\n        type=\"button\"\n        className=\"btn btn-secondary border\"\n        onClick={cancelDelete}\n      >\n        {trans(\"NO_CANCEL\")}\n      </button>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { trans, trans_fallback, trans_format, trans_obj } from \"../../i18n\";\nimport { RecordInfo } from \"../../components/types\";\n\nexport default function DeletePageHeader({\n  recordInfo,\n  currentAlt,\n}: {\n  recordInfo: RecordInfo;\n  currentAlt: string;\n}): JSX.Element {\n  const isPrimary = currentAlt === \"_primary\";\n  const altInfo = recordInfo.alts.find((a) => a.alt === currentAlt);\n\n  let label = trans_fallback(recordInfo.label_i18n, recordInfo.id);\n  if (!isPrimary && altInfo) {\n    label += ` (${trans_obj(altInfo.name_i18n)})`;\n  }\n\n  return (\n    <>\n      <h2>{trans_format(\"DELETE_RECORD\", label)}</h2>\n      {recordInfo.is_attachment ? (\n        <p>\n          {isPrimary\n            ? trans(\"DELETE_ATTACHMENT_PROMPT\")\n            : trans(\"DELETE_ATTACHMENT_ALT_PROMPT\")}{\" \"}\n        </p>\n      ) : (\n        <p>\n          {isPrimary\n            ? trans(\"DELETE_PAGE_PROMPT\")\n            : trans(\"DELETE_PAGE_ALT_PROMPT\")}{\" \"}\n          {recordInfo.children.length > 0 && isPrimary\n            ? trans(\"DELETE_PAGE_CHILDREN_WARNING\")\n            : null}\n        </p>\n      )}\n    </>\n  );\n}\n","import React, {\n  FormEvent,\n  SetStateAction,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport { Prompt } from \"react-router-dom\";\n\nimport { keyboardShortcutHandler } from \"../../utils\";\nimport { get, put } from \"../../fetch\";\nimport { trans, Translatable, trans_fallback, trans_format } from \"../../i18n\";\nimport {\n  getWidgetComponentWithFallback,\n  FieldBox,\n  FieldRows,\n  splitFields,\n} from \"../../widgets\";\nimport { showErrorDialog } from \"../../error-dialog\";\nimport { Field, WidgetComponent } from \"../../widgets/types\";\nimport { EditPageActions } from \"./EditPageActions\";\nimport ToggleGroup from \"../../components/ToggleGroup\";\nimport { useGoToAdminPage } from \"../../components/use-go-to-admin-page\";\nimport { useRecord } from \"../../context/record-context\";\n\nexport type RawRecordInfo = {\n  alt: string;\n  can_be_deleted: boolean;\n  default_template: string;\n  exists: boolean;\n  id: string;\n  implied_attachment_type: string | null;\n  is_attachment: boolean;\n  label: string;\n  label_i18n?: Translatable;\n  path: string;\n  slug_format: string;\n  url_path: string;\n};\n\ntype RecordDataModel = {\n  alt: string;\n  fields: Field[];\n};\n\nexport type RawRecord = {\n  datamodel: RecordDataModel;\n  record_info: RawRecordInfo;\n  data: Record<string, string>;\n};\n\nfunction legalFields(\n  recordDataModel: Pick<RecordDataModel, \"fields\">,\n  recordInfo: Pick<RawRecordInfo, \"is_attachment\">\n) {\n  function isLegalField(field: Field): boolean {\n    switch (field.name) {\n      case \"_id\":\n      case \"_path\":\n      case \"_gid\":\n      case \"_alt\":\n      case \"_source_alt\":\n      case \"_model\":\n      case \"_attachment_for\":\n        return false;\n      case \"_attachment_type\":\n        return recordInfo.is_attachment;\n    }\n    return true;\n  }\n  return recordDataModel.fields.filter(isLegalField);\n}\n\nfunction getPlaceholderForField(\n  recordInfo: RawRecordInfo,\n  Widget: WidgetComponent,\n  field: Field\n): string | null {\n  if (field.default !== null) {\n    if (Widget.deserializeValue) {\n      return Widget.deserializeValue(field.default, field.type);\n    }\n    return field.default;\n  } else if (field.name === \"_slug\") {\n    return recordInfo.slug_format;\n  } else if (field.name === \"_template\") {\n    return recordInfo.default_template;\n  } else if (field.name === \"_attachment_type\") {\n    return recordInfo.implied_attachment_type;\n  }\n  return null;\n}\n\nfunction getValueForField(\n  recordData: Record<string, string>,\n  Widget: WidgetComponent,\n  field: Field\n) {\n  let value = recordData[field.name];\n  if (value === undefined) {\n    value = \"\";\n    if (Widget.deserializeValue) {\n      value = Widget.deserializeValue(value, field.type);\n    }\n  }\n  return value;\n}\n\nfunction getValues({\n  recordDataModel,\n  recordInfo,\n  recordData,\n}: {\n  recordData: Record<string, string>;\n  recordDataModel: RecordDataModel | null;\n  recordInfo: RawRecordInfo | null;\n}): Record<string, string | null> {\n  const rv: Record<string, string | null> = {};\n  if (!recordDataModel || !recordInfo) {\n    return rv;\n  }\n  legalFields(recordDataModel, recordInfo).forEach((field) => {\n    let value: string | null = recordData[field.name];\n\n    if (value !== undefined) {\n      const Widget = getWidgetComponentWithFallback(field.type);\n      if (Widget.serializeValue) {\n        value = Widget.serializeValue(value, field.type);\n      }\n    } else {\n      value = null;\n    }\n\n    rv[field.name] = value;\n  });\n\n  return rv;\n}\n\nfunction EditPage(): JSX.Element | null {\n  const { path, alt } = useRecord();\n\n  const form = useRef<HTMLFormElement | null>(null);\n  // The deserialised record data.\n  const [recordData, setRecordData] = useState<Record<string, string>>({});\n  const [recordDataModel, setRecordDataModel] =\n    useState<RecordDataModel | null>(null);\n  const [recordInfo, setRecordnfo] = useState<RawRecordInfo | null>(null);\n  const [hasPendingChanges, setHasPendingChanges] = useState(false);\n\n  const goToAdminPage = useGoToAdminPage();\n\n  useEffect(() => {\n    let ignore = false;\n    get(\"/rawrecord\", { path, alt }).then(\n      ({ datamodel, data, record_info }) => {\n        if (!ignore) {\n          // transform response data into actual data\n          const recordData: Record<string, string> = {};\n          legalFields(datamodel, record_info).forEach((field) => {\n            const Widget = getWidgetComponentWithFallback(field.type);\n            let value = data[field.name];\n            if (value !== undefined) {\n              if (Widget.deserializeValue) {\n                value = Widget.deserializeValue(value, field.type);\n              }\n              recordData[field.name] = value;\n            }\n          });\n          setRecordData(recordData);\n          setRecordDataModel(datamodel);\n          setRecordnfo(record_info);\n          setHasPendingChanges(false);\n        }\n      },\n      showErrorDialog\n    );\n\n    return () => {\n      ignore = true;\n    };\n  }, [alt, path]);\n\n  useEffect(() => {\n    const onKeyPress = keyboardShortcutHandler(\n      { key: \"Control+s\", mac: \"Meta+s\", preventDefault: true },\n      () => {\n        if (hasPendingChanges) {\n          form.current?.requestSubmit();\n        } else {\n          goToAdminPage(\"preview\", path, alt);\n        }\n      }\n    );\n    window.addEventListener(\"keydown\", onKeyPress);\n    return () => window.removeEventListener(\"keydown\", onKeyPress);\n  }, [hasPendingChanges, goToAdminPage, path, alt]);\n\n  const setFieldValue = useCallback(\n    (fieldName: string, value: SetStateAction<string>) => {\n      setRecordData((r) => ({\n        ...r,\n        [fieldName]: typeof value === \"function\" ? value(r[fieldName]) : value,\n      }));\n      setHasPendingChanges(true);\n    },\n    []\n  );\n\n  const saveChanges = useCallback(\n    (ev: FormEvent) => {\n      ev.preventDefault();\n      const data = getValues({ recordDataModel, recordInfo, recordData });\n      put(\"/rawrecord\", { data, path, alt }).then(() => {\n        setHasPendingChanges(false);\n        goToAdminPage(\"preview\", path, alt);\n      }, showErrorDialog);\n    },\n    [alt, goToAdminPage, path, recordData, recordDataModel, recordInfo]\n  );\n\n  const renderFormField = useCallback(\n    (field: Field) => {\n      const Widget = getWidgetComponentWithFallback(field.type);\n      if (!recordInfo) {\n        return null;\n      }\n      // If alts_enabled is set, only show allow editing on alts (if true)\n      // or on the primary (if false)\n      const disabled = !(\n        field.alts_enabled === null ||\n        field.alts_enabled !== (recordInfo.alt === \"_primary\")\n      );\n      return (\n        <FieldBox\n          key={field.name}\n          value={getValueForField(recordData, Widget, field)}\n          placeholder={getPlaceholderForField(recordInfo, Widget, field)}\n          field={field}\n          setFieldValue={setFieldValue}\n          disabled={disabled}\n        />\n      );\n    },\n    [recordData, recordInfo, setFieldValue]\n  );\n\n  if (!recordInfo || !recordDataModel) {\n    // we have not loaded anything yet.\n    return null;\n  }\n\n  const label = trans_fallback(recordInfo.label_i18n, recordInfo.label);\n\n  const title = recordInfo.is_attachment\n    ? trans_format(\"EDIT_ATTACHMENT_METADATA_OF\", label)\n    : trans_format(\"EDIT_PAGE_NAME\", label);\n\n  const fields = legalFields(recordDataModel, recordInfo);\n  const [normalFields, systemFields] = splitFields(fields);\n\n  return (\n    <>\n      {hasPendingChanges && <Prompt message={trans(\"UNLOAD_ACTIVE_TAB\")} />}\n      <h2>{title}</h2>\n      <form ref={form} onSubmit={saveChanges}>\n        <FieldRows fields={normalFields} renderFunc={renderFormField} />\n        {systemFields.length > 0 && (\n          <ToggleGroup\n            groupTitle={trans(\"SYSTEM_FIELDS\")}\n            className=\"system-fields\"\n          >\n            <FieldRows fields={systemFields} renderFunc={renderFormField} />\n          </ToggleGroup>\n        )}\n        <EditPageActions\n          recordInfo={recordInfo}\n          hasPendingChanges={hasPendingChanges}\n        />\n      </form>\n    </>\n  );\n}\n\nexport default EditPage;\n","import React, { useCallback } from \"react\";\nimport { useRecord } from \"../../context/record-context\";\nimport { useGoToAdminPage } from \"../../components/use-go-to-admin-page\";\nimport { trans } from \"../../i18n\";\nimport { RawRecordInfo } from \"./EditPage\";\n\nexport function EditPageActions({\n  recordInfo,\n  hasPendingChanges,\n}: {\n  recordInfo: RawRecordInfo;\n  hasPendingChanges: boolean;\n}): JSX.Element {\n  const { path, alt } = useRecord();\n  const goToAdminPage = useGoToAdminPage();\n\n  const deleteRecord = useCallback(() => {\n    goToAdminPage(\"delete\", path, alt);\n  }, [alt, goToAdminPage, path]);\n\n  return (\n    <div className=\"actions\">\n      <button\n        type=\"submit\"\n        disabled={!hasPendingChanges}\n        className=\"btn btn-primary\"\n      >\n        {trans(\"SAVE_CHANGES\")}\n      </button>\n      {recordInfo.can_be_deleted ? (\n        <button\n          type=\"button\"\n          className=\"btn btn-secondary border\"\n          onClick={deleteRecord}\n        >\n          {trans(\"DELETE\")}\n        </button>\n      ) : null}\n    </div>\n  );\n}\n","import React, { ReactNode, SetStateAction, useCallback, useMemo } from \"react\";\nimport { IntegerInputWidget } from \"./widgets/IntegerInputWidget\";\nimport { MultiLineTextInputWidget } from \"./widgets/MultiLineTextInputWidget\";\nimport { BooleanInputWidget } from \"./widgets/BooleanInputWidget\";\nimport { DateInputWidget } from \"./widgets/DateInputWidget\";\nimport { FloatInputWidget } from \"./widgets/FloatInputWidget\";\nimport { UrlInputWidget } from \"./widgets/UrlInputWidget\";\nimport { SlugInputWidget } from \"./widgets/SlugInputWidget\";\nimport { SingleLineTextInputWidget } from \"./widgets/SingleLineTextInputWidget\";\nimport { CheckboxesInputWidget } from \"./widgets/CheckboxesInputWidget\";\nimport { SelectInputWidget } from \"./widgets/SelectInputWidget\";\nimport { FlowWidget } from \"./widgets/flow/FlowWidget\";\nimport {\n  LineWidget,\n  SpacingWidget,\n  InfoWidget,\n  HeadingWidget,\n} from \"./widgets/fakeWidgets\";\nimport {\n  Field,\n  WidgetComponent,\n  WidgetProps,\n  WidgetType,\n} from \"./widgets/types\";\nimport { trans_obj } from \"./i18n\";\n\nconst widgetComponents = {\n  \"singleline-text\": SingleLineTextInputWidget,\n  \"multiline-text\": MultiLineTextInputWidget,\n  datepicker: DateInputWidget,\n  integer: IntegerInputWidget,\n  float: FloatInputWidget,\n  checkbox: BooleanInputWidget,\n  url: UrlInputWidget,\n  slug: SlugInputWidget,\n  flow: FlowWidget,\n  checkboxes: CheckboxesInputWidget,\n  select: SelectInputWidget,\n  \"f-line\": LineWidget,\n  \"f-spacing\": SpacingWidget,\n  \"f-info\": InfoWidget,\n  \"f-heading\": HeadingWidget,\n};\n\n/**\n * A fallback widget to render for fields missing a component.\n */\nfunction FallbackWidget(props: WidgetProps) {\n  return (\n    <div>\n      <em>\n        {`Widget \"${props.type.widget}\" not implemented`}\n        {` (used by type \"${props.type.name}\")`}\n      </em>\n    </div>\n  );\n}\n\n/**\n * An input widget wrapped in a <div> with description and label.\n */\nexport const FieldBox = React.memo(function FieldBox(props: {\n  field: Field;\n  value: string;\n  placeholder: string | null;\n  disabled?: boolean;\n  setFieldValue: (fieldName: string, value: SetStateAction<string>) => void;\n}) {\n  const { field, value, placeholder, disabled, setFieldValue } = props;\n\n  const onChange = useCallback(\n    (value: SetStateAction<string>) => setFieldValue(field.name, value),\n    [field, setFieldValue]\n  );\n  const className = `col-md-${getFieldColumns(field)}`;\n\n  const Widget = getWidgetComponentWithFallback(field.type);\n  if (Widget.isFakeWidget) {\n    return (\n      <div className={className} key={field.name}>\n        <Widget key={field.name} field={field} />\n      </div>\n    );\n  }\n\n  const description = field.description_i18n ? (\n    <div className=\"help-text\">{trans_obj(field.description_i18n)}</div>\n  ) : null;\n\n  return (\n    <div className={className} key={field.name}>\n      <dl className=\"field\">\n        {!field.hide_label ? <dt>{trans_obj(field.label_i18n)}</dt> : null}\n        <dd>\n          {description}\n          <Widget\n            value={value}\n            onChange={onChange}\n            type={field.type}\n            placeholder={placeholder ?? undefined}\n            disabled={disabled}\n          />\n        </dd>\n      </dl>\n    </div>\n  );\n});\n\nexport function getWidgetComponent(type: WidgetType): WidgetComponent | null {\n  // @ts-expect-error This is hard to type and not typed yet.\n  return widgetComponents[type.widget] || null;\n}\n\nexport function getWidgetComponentWithFallback(\n  type: WidgetType\n): WidgetComponent {\n  // @ts-expect-error This is hard to type and not typed yet.\n  return widgetComponents[type.widget] || FallbackWidget;\n}\n\n/**\n * Get the width of a field in columns.\n */\nexport function getFieldColumns(field: {\n  type: Pick<WidgetType, \"width\">;\n}): number {\n  const widthSpec = (field.type.width || \"1/1\").split(\"/\");\n  const fraction = (12 * +widthSpec[0]) / +widthSpec[1];\n  return Number.isNaN(fraction)\n    ? 12\n    : Math.min(12, Math.max(2, parseInt(`${fraction}`)));\n}\n\n/**\n * Process fields into rows.\n */\nfunction processFields(fields: Field[]): Field[][] {\n  const rows: Field[][] = [];\n  let currentColumns = 0;\n  let row: Field[] = [];\n\n  fields.forEach((field) => {\n    const columns = getFieldColumns(field);\n    if (columns + currentColumns > 12) {\n      rows.push(row);\n      currentColumns = 0;\n      row = [];\n    }\n    row.push(field);\n    currentColumns += columns;\n  });\n\n  if (row.length > 0) {\n    rows.push(row);\n  }\n  return rows;\n}\n\n/**\n * Split the fields into normal and system fields.\n */\nexport function splitFields(fields: Field[]): [Field[], Field[]] {\n  const normalFields: Field[] = [];\n  const systemFields: Field[] = [];\n\n  fields.forEach((field) => {\n    if (field.name.substr(0, 1) === \"_\") {\n      systemFields.push(field);\n    } else {\n      normalFields.push(field);\n    }\n  });\n\n  return [normalFields, systemFields];\n}\n\n/**\n * Render field rows using a render function.\n */\nexport function FieldRows({\n  fields,\n  renderFunc,\n}: {\n  fields: Field[];\n  renderFunc: (field: Field) => ReactNode;\n}): JSX.Element {\n  const rows = useMemo(() => processFields(fields), [fields]);\n  return (\n    <>\n      {rows.map((row, idx) => (\n        <div key={idx} className=\"row field-row\">\n          {row.map(renderFunc)}\n        </div>\n      ))}\n    </>\n  );\n}\n","import React from \"react\";\nimport { WidgetProps } from \"./types\";\nimport { trans_obj } from \"../i18n\";\n\nconst isTrue = (value?: string) =>\n  value === \"true\" || value === \"yes\" || value === \"1\";\n\nexport function BooleanInputWidget({\n  type,\n  value,\n  disabled,\n  placeholder,\n  onChange,\n}: WidgetProps): JSX.Element {\n  return (\n    <div className=\"form-check\">\n      <label className=\"form-check-label\">\n        <input\n          type=\"checkbox\"\n          className=\"form-check-input\"\n          disabled={disabled}\n          ref={(checkbox) => {\n            if (checkbox) {\n              if (!value && placeholder) {\n                checkbox.indeterminate = true;\n                checkbox.checked = isTrue(placeholder);\n              } else {\n                checkbox.indeterminate = false;\n              }\n            }\n          }}\n          checked={isTrue(value)}\n          onChange={(ev) => {\n            onChange(ev.target.checked ? \"yes\" : \"no\");\n          }}\n        />\n        {type.checkbox_label_i18n ? trans_obj(type.checkbox_label_i18n) : null}\n      </label>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { trans_obj } from \"../i18n\";\nimport { MultiWidgetType, WidgetProps } from \"./types\";\n\nconst checkboxIsActive = (field: string, value: string[] | null) =>\n  value !== null && value.includes(field);\n\nconst flipSetValue = (set: string[], value: string, isActive: boolean) => {\n  if (isActive) {\n    return set.includes(value) ? set : [...set, value];\n  } else {\n    return set.filter((v) => v !== value);\n  }\n};\n\nconst deserialize = (value?: string): string[] | null => {\n  if (!value) {\n    return null;\n  }\n  let rv = value.split(\",\").map((x) => x.trim());\n  if (rv.length === 1 && rv[0] === \"\") {\n    rv = [];\n  }\n  return rv;\n};\n\nexport function CheckboxesInputWidget({\n  disabled,\n  type,\n  onChange,\n  value,\n  placeholder,\n}: WidgetProps<string, MultiWidgetType>): JSX.Element {\n  const deserializedValue = deserialize(value);\n  const deserializedPlaceholder = deserialize(placeholder);\n\n  return (\n    <div className=\"checkboxes-widget\">\n      {type.choices?.map(([key, description]) => (\n        <div className=\"form-check\" key={key}>\n          <label className=\"form-check-label\">\n            <input\n              className=\"form-check-input\"\n              type=\"checkbox\"\n              disabled={disabled}\n              checked={checkboxIsActive(\n                key,\n                deserializedValue ?? deserializedPlaceholder\n              )}\n              onChange={(ev) => {\n                const newValue = flipSetValue(\n                  deserializedValue || [],\n                  key,\n                  ev.target.checked\n                );\n                onChange(newValue.join(\", \"));\n              }}\n            />\n            {trans_obj(description)}\n          </label>\n        </div>\n      ))}\n    </div>\n  );\n}\n","import React from \"react\";\nimport { WidgetProps } from \"./types\";\nimport { trans } from \"../i18n\";\nimport InputWidgetBase from \"./InputWidgetBase\";\n\nconst parseInteger = (s: string) => Number.parseInt(s, 10);\n\nexport function isValidDate(year: number, month: number, day: number): boolean {\n  const date = new Date(year, month - 1, day);\n  return (\n    date.getFullYear() === year &&\n    date.getMonth() === month - 1 &&\n    date.getDate() === day\n  );\n}\n\nconst DATE_RE = /^\\s*(?<year>\\d{4})-(?<month>\\d{1,2})-(?<day>\\d{1,2})\\s*$/;\n\nexport function validateDate(value: string): string | null {\n  if (!value) {\n    return null;\n  }\n\n  const groups = value.match(DATE_RE)?.groups;\n  if (\n    groups &&\n    isValidDate(\n      parseInteger(groups.year),\n      parseInteger(groups.month),\n      parseInteger(groups.day)\n    )\n  ) {\n    return null;\n  }\n\n  return trans(\"ERROR_INVALID_DATE\");\n}\nconst REVERSE_DATE_RE =\n  /^(?<day>\\d{1,2})\\.(?<month>\\d{1,2})\\.(?<year>\\d{4})\\s*$/;\n\nconst pad = (n: number) => (n < 10 ? `0${n}` : `${n}`);\n\nexport function postprocessDate(value: string): string {\n  value = value.trim();\n  const groups = value.match(REVERSE_DATE_RE)?.groups;\n  if (groups) {\n    const day = parseInteger(groups.day);\n    const month = parseInteger(groups.month);\n    const year = parseInteger(groups.year);\n    return `${year}-${pad(month)}-${pad(day)}`;\n  }\n  return value;\n}\n\nconst inputAddon = <i className=\"fa fa-calendar\" />;\n\nexport function DateInputWidget(props: WidgetProps): JSX.Element {\n  return (\n    <InputWidgetBase\n      inputType=\"date\"\n      inputAddon={inputAddon}\n      postprocessValue={postprocessDate}\n      validate={validateDate}\n      {...props}\n    />\n  );\n}\n","import React from \"react\";\nimport { WidgetProps } from \"./types\";\nimport { trans } from \"../i18n\";\nimport InputWidgetBase from \"./InputWidgetBase\";\n\nfunction postprocessFloat(value: string) {\n  return value.trim();\n}\n\nfunction validateFloat(value: string) {\n  if (value && !value.match(/^[+,-]?\\d+[.]\\d+$/)) {\n    return trans(\"ERROR_INVALID_NUMBER\");\n  }\n  return null;\n}\n\nexport function FloatInputWidget(props: WidgetProps): JSX.Element {\n  return (\n    <InputWidgetBase\n      inputType=\"text\"\n      inputAddon=\"0.0\"\n      postprocessValue={postprocessFloat}\n      validate={validateFloat}\n      {...props}\n    />\n  );\n}\n","import React, { ChangeEvent, useCallback } from \"react\";\nimport { formatUserLabel } from \"../userLabel\";\nimport { getInputClass, WidgetProps } from \"./types\";\n\nexport default function InputWidgetBase({\n  type,\n  value,\n  onChange,\n  postprocessValue,\n  inputAddon,\n  inputType,\n  validate,\n  disabled,\n  placeholder,\n}: WidgetProps & {\n  postprocessValue?: (val: string) => string;\n  inputAddon: JSX.Element | string;\n  inputType: string;\n  validate?: (val: string) => string | null;\n}): JSX.Element {\n  const onChangeHandler = useCallback(\n    (event: ChangeEvent<HTMLInputElement>) => {\n      let value = event.target.value;\n      if (postprocessValue) {\n        value = postprocessValue(value);\n      }\n      onChange(value);\n    },\n    [onChange, postprocessValue]\n  );\n\n  const failure = validate ? validate(value) : null;\n  const setValidity = (el: HTMLInputElement | null) => {\n    el?.setCustomValidity(failure ?? \"\");\n  };\n\n  const configuredAddon = type.addon_label_i18n;\n  const addon = configuredAddon ? formatUserLabel(configuredAddon) : inputAddon;\n\n  return (\n    <>\n      <div className=\"input-group\">\n        <input\n          ref={setValidity}\n          type={inputType}\n          disabled={disabled}\n          placeholder={placeholder}\n          className={getInputClass(type)}\n          onChange={onChangeHandler}\n          value={value || \"\"}\n        />\n        <span className=\"input-group-text\">{addon}</span>\n      </div>\n      {failure !== null && (\n        <div className={\"validation-block validation-block-error\"}>\n          {failure}\n        </div>\n      )}\n    </>\n  );\n}\n","import React from \"react\";\nimport { WidgetProps } from \"./types\";\nimport { trans } from \"../i18n\";\nimport InputWidgetBase from \"./InputWidgetBase\";\n\nfunction postprocessInteger(value: string) {\n  return value.trim();\n}\n\nfunction validateInteger(value: string) {\n  if (value && !value.match(/^-?\\d+$/)) {\n    return trans(\"ERROR_INVALID_NUMBER\");\n  }\n  return null;\n}\n\nexport function IntegerInputWidget(props: WidgetProps): JSX.Element {\n  return (\n    <InputWidgetBase\n      inputType=\"text\"\n      inputAddon=\"0\"\n      postprocessValue={postprocessInteger}\n      validate={validateInteger}\n      {...props}\n    />\n  );\n}\n","import React, { ChangeEvent } from \"react\";\nimport { getInputClass, WidgetProps } from \"./types\";\n\nexport function MultiLineTextInputWidget({\n  type,\n  value,\n  placeholder,\n  disabled,\n  onChange: onChangeProp,\n}: WidgetProps) {\n  const onChange = (event: ChangeEvent<HTMLTextAreaElement>) => {\n    onChangeProp(event.target.value);\n  };\n\n  /* How this works\n   *\n   * The idea is ripped off from here:\n   *\n   *   https://css-tricks.com/the-cleanest-trick-for-autogrowing-textareas/\n   *\n   * We stack an (invisible) <div> under our <textarea> in a container\n   * with display: grid.\n   *\n   * The issue we are trying to solve is that <textarea>s do not expand\n   * when content is added to them.  However, <div>s do!\n   *\n   * The contents of the <textarea> is duplicated to the <div>. The\n   * grid layout ensures that when the <div> expands, the <textarea> is\n   * expanded to match.\n   */\n  return (\n    <div className=\"text-widget\">\n      <div className=\"text-widget__replica\">{value}</div>\n      <textarea\n        className={`${getInputClass(type)} text-widget__textarea`}\n        onChange={onChange}\n        value={value}\n        disabled={disabled}\n        placeholder={placeholder}\n      />\n    </div>\n  );\n}\n","import React from \"react\";\nimport { trans_obj } from \"../i18n\";\nimport { getInputClass, MultiWidgetType, WidgetProps } from \"./types\";\n\nexport function SelectInputWidget(\n  props: WidgetProps<string, MultiWidgetType>\n): JSX.Element {\n  const { type, value, placeholder, onChange, disabled } = props;\n\n  const choices = type.choices?.map((item) => (\n    <option key={item[0]} value={item[0]}>\n      {trans_obj(item[1])}\n    </option>\n  ));\n\n  return (\n    <div>\n      <select\n        className={getInputClass(type)}\n        value={value || placeholder || \"\"}\n        onChange={(e) => onChange(e.target.value)}\n        disabled={disabled}\n      >\n        <option key=\"\" value=\"\">\n          ----\n        </option>\n        {choices}\n      </select>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { WidgetProps } from \"./types\";\nimport InputWidgetBase from \"./InputWidgetBase\";\n\nconst inputAddon = <i className=\"fa fa-paragraph\" />;\n\nexport function SingleLineTextInputWidget(props: WidgetProps): JSX.Element {\n  return (\n    <InputWidgetBase inputType=\"text\" inputAddon={inputAddon} {...props} />\n  );\n}\n","import React from \"react\";\nimport { WidgetProps } from \"./types\";\nimport InputWidgetBase from \"./InputWidgetBase\";\n\nfunction postprocessSlug(value: string) {\n  return value.replace(/\\s+/g, \"-\");\n}\n\nconst inputAddon = <i className=\"fa fa-link\" />;\n\nexport function SlugInputWidget(props: WidgetProps): JSX.Element {\n  return (\n    <InputWidgetBase\n      inputType=\"text\"\n      inputAddon={inputAddon}\n      postprocessValue={postprocessSlug}\n      {...props}\n    />\n  );\n}\n","import React from \"react\";\nimport { WidgetProps } from \"./types\";\nimport InputWidgetBase from \"./InputWidgetBase\";\nimport { isValidUrl } from \"../utils\";\nimport { trans } from \"../i18n\";\n\nfunction validateUrl(value: string) {\n  if (value && !isValidUrl(value)) {\n    return trans(\"ERROR_INVALID_URL\");\n  }\n  return null;\n}\n\nconst inputAddon = <i className=\"fa fa-external-link\" />;\n\nexport function UrlInputWidget(props: WidgetProps): JSX.Element {\n  return (\n    <InputWidgetBase\n      inputType=\"text\"\n      inputAddon={inputAddon}\n      validate={validateUrl}\n      {...props}\n    />\n  );\n}\n","import { Field } from \"./types\";\nimport React from \"react\";\nimport { trans_obj } from \"../i18n\";\n\nexport function LineWidget(): JSX.Element {\n  return <hr />;\n}\nLineWidget.isFakeWidget = true;\n\nexport function SpacingWidget(): JSX.Element {\n  return <div className=\"spacing-widget\" />;\n}\nSpacingWidget.isFakeWidget = true;\n\nexport function InfoWidget(props: { field: Field }): JSX.Element {\n  const label = trans_obj(props.field.label_i18n);\n  return (\n    <div className=\"info-widget\">\n      <p>\n        {label ? <strong>{label + \": \"}</strong> : null}\n        {trans_obj(props.field.description_i18n)}\n      </p>\n    </div>\n  );\n}\nInfoWidget.isFakeWidget = true;\n\nexport function HeadingWidget(props: { field: Field }): JSX.Element {\n  return <h3>{trans_obj(props.field.type.heading_i18n ?? {})}</h3>;\n}\nHeadingWidget.isFakeWidget = true;\n","import React from \"react\";\nimport { trans, trans_obj } from \"../../i18n\";\nimport { formatUserLabel } from \"../../userLabel\";\nimport { FlowBlockModel } from \"./FlowWidget\";\n\nexport default function AddFlowBlockButtons({\n  flowblock_order,\n  flowblocks,\n  addBlock,\n}: {\n  flowblocks: Record<string, FlowBlockModel>;\n  flowblock_order: string[];\n  addBlock: (model: FlowBlockModel) => void;\n}): JSX.Element {\n  const models = flowblock_order.map((key) => flowblocks[key]);\n  return (\n    <div className=\"add-flow-block\">\n      <label>{`${trans(\"ADD_FLOWBLOCK\")}: `}</label>\n      <div className=\"btn-group\">\n        {models.map((model) => {\n          const label = model.button_label\n            ? formatUserLabel(model.button_label)\n            : formatUserLabel(model.name_i18n);\n          return (\n            <button\n              type=\"button\"\n              className=\"btn btn-secondary border\"\n              onClick={() => addBlock(model)}\n              title={trans_obj(model.name_i18n)}\n              key={model.id}\n            >\n              {label}\n            </button>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n","import React, { memo, useReducer } from \"react\";\nimport { trans } from \"../../i18n\";\nimport { formatUserLabel } from \"../../userLabel\";\nimport { Field } from \"../types\";\nimport { FieldRows } from \"../../widgets\";\nimport { FlowBlockData } from \"./FlowWidget\";\n\n/**\n * Render a single flow block in the flow widget. The function to render\n * the child input widgets is passed down.\n */\nexport default memo(function FlowBlock({\n  block,\n  moveBlock,\n  renderFormField,\n  removeBlock,\n  idx,\n  length,\n}: {\n  block: FlowBlockData;\n  moveBlock: (i: number, s: number) => void;\n  renderFormField: (b: FlowBlockData, f: Field) => JSX.Element;\n  removeBlock: (i: number) => void;\n  idx: number;\n  length: number;\n}) {\n  const [collapsed, toggle] = useReducer((s) => !s, false);\n  return (\n    <div className=\"flow-block\">\n      <div className=\"d-flex justify-content-between\">\n        <h4 className=\"block-name\">{formatUserLabel(block.model.name_i18n)}</h4>\n        <div className=\"btn-group action-bar\">\n          <button\n            type=\"button\"\n            className=\"btn btn-secondary btn-sm border\"\n            title={collapsed ? trans(\"EXPAND\") : trans(\"COLLAPSE\")}\n            onClick={toggle}\n          >\n            <i className={collapsed ? \"fa fa-expand\" : \"fa fa-compress\"} />\n          </button>\n          <button\n            type=\"button\"\n            className=\"btn btn-secondary btn-sm border\"\n            title={trans(\"UP\")}\n            disabled={idx === 0}\n            onClick={() => moveBlock(idx, -1)}\n          >\n            <i className=\"fa fa-fw fa-chevron-up\" />\n          </button>\n          <button\n            type=\"button\"\n            className=\"btn btn-secondary btn-sm border\"\n            title={trans(\"DOWN\")}\n            disabled={idx === length - 1}\n            onClick={() => moveBlock(idx, 1)}\n          >\n            <i className=\"fa fa-fw fa-chevron-down\" />\n          </button>\n          <button\n            type=\"button\"\n            className=\"btn btn-secondary btn-sm border\"\n            title={trans(\"REMOVE\")}\n            onClick={() => removeBlock(idx)}\n          >\n            <i className=\"fa fa-fw fa-times\" />\n          </button>\n        </div>\n      </div>\n      {collapsed ? null : (\n        <FieldRows\n          fields={block.model.fields}\n          renderFunc={renderFormField.bind(undefined, block)}\n        />\n      )}\n    </div>\n  );\n});\n","import React, { SetStateAction, useCallback } from \"react\";\nimport { trans, Translatable } from \"../../i18n\";\nimport { tokenize, serialize } from \"./metaformat\";\nimport { Field, BaseWidgetType, WidgetProps } from \"../types\";\nimport {\n  getWidgetComponent,\n  getWidgetComponentWithFallback,\n  FieldBox,\n} from \"../../widgets\";\nimport FlowBlock from \"./FlowBlock\";\nimport AddFlowBlockButtons from \"./AddFlowBlockButtons\";\n\ntype Block = [name: string, lines: string[]];\n\n/**\n * Parse the row string from a Lektor file for the flow format\n * to its separate flow blocks. Each flow block can then be\n * deserialised with deserializeFlowBlock.\n */\nexport function parseFlowFormat(value = \"\"): Block[] {\n  const blocks: Block[] = [];\n  const lines = value.split(/\\r?\\n/);\n  let blockName: string | null = null;\n  let blockLines: string[] = [];\n\n  const flush = () => {\n    if (blockName !== null) {\n      blocks.push([blockName, blockLines]);\n      blockLines = [];\n    }\n  };\n\n  for (const line of lines) {\n    // leading whitespace is ignored.\n    if (blockName === null && line.match(/^\\s*$/)) {\n      continue;\n    }\n\n    const blockStart = line.match(/^####\\s*([^#]*?)\\s*####\\s*$/);\n    if (!blockStart) {\n      if (blockName === null) {\n        // bad format :(\n        return [];\n      }\n    } else {\n      flush();\n      blockName = blockStart[1];\n      continue;\n    }\n\n    blockLines.push(line.replace(/^#####(.*?)#####$/, \"####$1####\"));\n  }\n\n  flush();\n  return blocks;\n}\n\n/** Serialise an array of single blocks to a string. */\nexport function serializeFlowFormat(blocks: Block[]): string {\n  const serialisedBlocks: string[] = [];\n  blocks.forEach(([blockName, lines]) => {\n    serialisedBlocks.push(`#### ${blockName} ####\\n`);\n    lines.forEach((line) => {\n      serialisedBlocks.push(line.replace(/^(####(.*)####)(\\r?\\n)?$/, \"#$1#$3\"));\n    });\n  });\n\n  const rv = serialisedBlocks.join(\"\");\n\n  /* we need to chop of the last newline if it exists because this would\n     otherwise add a newline to the last block.  This is just a side effect\n     of how we serialize the meta format internally */\n  return rv[rv.length - 1] === \"\\n\" ? rv.substr(0, rv.length - 1) : rv;\n}\n\nexport interface FlowBlockModel {\n  order: number;\n  id: string;\n  fields: Field[];\n  name: string;\n  name_i18n: Translatable;\n  button_label?: string;\n}\n\nexport interface FlowBlockWidgetType extends BaseWidgetType {\n  widget: \"flow\";\n  flowblock_order: string[];\n  flowblocks: Record<string, FlowBlockModel>;\n}\n\nexport interface FlowBlockData {\n  /** The current data for this flow block. */\n  data: Record<string, string>;\n  /** The data model of the flow block. */\n  model: FlowBlockModel;\n  /** A key to identify this item to React (needed when moving them up/down). */\n  localId: number;\n}\n\nfunction deserializeFlowBlock(\n  model: FlowBlockModel,\n  lines: string[],\n  localId: number\n): FlowBlockData {\n  const data: Record<string, string> = {};\n  const rawData: Record<string, string> = {};\n\n  tokenize(lines).forEach(([key, lines]) => {\n    rawData[key] = lines.join(\"\");\n  });\n\n  model.fields.forEach((field) => {\n    let value = rawData[field.name] || \"\";\n    const Widget = getWidgetComponent(field.type);\n    if (!value && field.default) {\n      value = field.default;\n    }\n    if (Widget && Widget.deserializeValue) {\n      value = Widget.deserializeValue(value, field.type);\n    }\n    data[field.name] = value;\n  });\n\n  return { localId, model, data };\n}\n\nfunction serializeFlowBlock(\n  flockBlockModel: FlowBlockModel,\n  data: Record<string, string>\n) {\n  const rv: [string, string][] = [];\n  flockBlockModel.fields.forEach((field) => {\n    const Widget = getWidgetComponent(field.type);\n    if (Widget === null) {\n      return;\n    }\n\n    let value = data[field.name];\n    if (value === undefined || value === null) {\n      return;\n    }\n\n    if (Widget.serializeValue) {\n      value = Widget.serializeValue(value, field.type);\n    }\n    rv.push([field.name, value]);\n  });\n  return serialize(rv);\n}\n\nexport function FlowWidget(\n  props: WidgetProps<readonly FlowBlockData[], FlowBlockWidgetType>\n): JSX.Element {\n  const { value, onChange } = props;\n\n  const moveBlock = useCallback(\n    (idx: number, offset: number) => {\n      onChange((prevValue) => {\n        const newIndex = idx + offset;\n        if (newIndex < 0 || newIndex >= prevValue.length) {\n          return prevValue;\n        }\n\n        const newValue = [...prevValue];\n        newValue[newIndex] = prevValue[idx];\n        newValue[idx] = prevValue[newIndex];\n        return newValue;\n      });\n    },\n    [onChange]\n  );\n\n  const removeBlock = useCallback(\n    (idx: number) => {\n      if (confirm(trans(\"REMOVE_FLOWBLOCK_PROMPT\"))) {\n        onChange((v) => v.filter((item, i) => i !== idx));\n      }\n    },\n    [onChange]\n  );\n\n  const addNewBlock = useCallback(\n    (flowBlockModel: FlowBlockModel) => {\n      onChange((prevValue) => {\n        // find the first available id for this new block - use findMax + 1\n        prevValue ??= [];\n        const newBlockId =\n          Math.max(0, ...prevValue.map(({ localId }) => localId)) + 1;\n        // this is a rather ugly way to do this, but hey, it works.\n        const newBlock = deserializeFlowBlock(flowBlockModel, [], newBlockId);\n        return [...prevValue, newBlock];\n      });\n    },\n    [onChange]\n  );\n\n  const renderFormField = useCallback(\n    (block: FlowBlockData, field: Field) => {\n      const fieldValue = block.data[field.name];\n      let placeholder = field.default;\n      const Widget = getWidgetComponentWithFallback(field.type);\n      if (Widget.deserializeValue && placeholder != null) {\n        placeholder = Widget.deserializeValue(placeholder, field.type);\n      }\n\n      const setFieldValue = (fieldName: string, v: SetStateAction<string>) => {\n        onChange((prevValue) => {\n          const newValue = [...prevValue];\n          const idx = newValue.indexOf(block);\n          const data = {\n            ...block.data,\n            [fieldName]: typeof v === \"function\" ? v(block.data[fieldName]) : v,\n          };\n          newValue[idx] = { ...block, data };\n          return newValue;\n        });\n      };\n\n      return (\n        <FieldBox\n          key={field.name}\n          value={fieldValue}\n          placeholder={placeholder}\n          field={field}\n          setFieldValue={setFieldValue}\n        />\n      );\n    },\n    [onChange]\n  );\n\n  const { flowblock_order, flowblocks } = props.type;\n  return (\n    <div className=\"flow-widget\">\n      {value.map((block, idx) => (\n        <FlowBlock\n          key={block.localId}\n          block={block}\n          moveBlock={moveBlock}\n          renderFormField={renderFormField}\n          removeBlock={removeBlock}\n          length={value.length}\n          idx={idx}\n        />\n      ))}\n      <AddFlowBlockButtons\n        flowblock_order={flowblock_order}\n        flowblocks={flowblocks}\n        addBlock={addNewBlock}\n      />\n    </div>\n  );\n}\n\nFlowWidget.deserializeValue = (\n  value: string,\n  { flowblocks }: FlowBlockWidgetType\n): FlowBlockData[] => {\n  let blockId = 0;\n  const blocks: FlowBlockData[] = [];\n  parseFlowFormat(value).forEach(([id, lines]) => {\n    const flowBlock = flowblocks[id];\n    if (flowBlock !== undefined) {\n      blocks.push(deserializeFlowBlock(flowBlock, lines, ++blockId));\n    }\n  });\n  return blocks;\n};\n\nFlowWidget.serializeValue = (value: FlowBlockData[]) => {\n  return serializeFlowFormat(\n    value.map(({ model: flowBlockModel, data }) => [\n      flowBlockModel.id,\n      serializeFlowBlock(flowBlockModel, data),\n    ])\n  );\n};\n","/** Check whether the (trimmed) line is at least 3 chars wide and only dashes. */\nexport function lineIsDashes(rawLine: string): boolean {\n  const line = rawLine.trim();\n  return line.length >= 3 && line.match(/[^-]/) === null;\n}\n\nexport function processBuf(buf: string[]): string[] {\n  if (buf.length === 0) {\n    return buf;\n  }\n  const lines = buf.map((line) => (lineIsDashes(line) ? line.substr(1) : line));\n  const lastLine = lines[lines.length - 1];\n  if (lastLine[lastLine.length - 1] === \"\\n\") {\n    // trim newline at the end of the last line.\n    lines[lines.length - 1] = lastLine.substr(0, lastLine.length - 1);\n  }\n  return lines;\n}\n\nfunction trimTabsAndSpaces(str: string): string {\n  const match = str.match(/^[\\t ]*(.*?)[\\t ]*$/m);\n  return match ? match[1] : \"\";\n}\n\nexport function tokenize(lines: string[]): [string, string[]][] {\n  let key: string | null = null;\n  let buf: string[] = [];\n  let wantNewline = false;\n  const rv: [string, string[]][] = [];\n\n  function flushItem() {\n    if (key !== null) {\n      rv.push([key, processBuf(buf)]);\n      key = null;\n      buf = [];\n    }\n  }\n\n  for (let i = 0; i < lines.length; i++) {\n    const match = lines[i].match(/^(.*?)(\\r?\\n)*$/m);\n    const line = match ? `${match[1]}\\n` : \"\\n\";\n\n    if (line.trimRight() === \"---\") {\n      wantNewline = false;\n      flushItem();\n    } else if (key !== null) {\n      if (wantNewline) {\n        wantNewline = false;\n        if (line.match(/^\\s*$/)) {\n          continue;\n        }\n      }\n      buf.push(line);\n    } else {\n      const bits = line.split(\":\");\n      if (bits.length >= 2) {\n        const [rawKey, ...rest] = bits;\n        key = rawKey.trim();\n        const firstBit = trimTabsAndSpaces(rest.join(\":\"));\n        if (!firstBit.match(/^\\s*$/)) {\n          buf = [firstBit];\n        } else {\n          buf = [];\n          wantNewline = true;\n        }\n      }\n    }\n  }\n\n  flushItem();\n  return rv;\n}\n\nexport function serialize(blocks: [string, string][]): string[] {\n  const rv: string[] = [];\n\n  blocks.forEach((item, idx) => {\n    const [key, value] = item;\n    if (idx > 0) {\n      rv.push(\"---\\n\");\n    }\n    if (value.match(/([\\r\\n]|(^[\\t ])|([\\t ]$))/m)) {\n      rv.push(key + \":\\n\");\n      rv.push(\"\\n\");\n      const lines = value.split(/\\n/);\n      if (lines[lines.length - 1] === \"\") {\n        lines.pop();\n      }\n      lines.forEach((line) => {\n        rv.push(lineIsDashes(line) ? `-${line}\\n` : `${line}\\n`);\n      });\n    } else {\n      rv.push(key + \": \" + value + \"\\n\");\n    }\n  });\n\n  return rv;\n}\n","import { ComponentType, SetStateAction } from \"react\";\nimport { Translatable } from \"../i18n\";\n\nexport interface BaseWidgetType {\n  widget: string;\n  name: string;\n  size: \"normal\" | \"small\" | \"large\";\n  width?: string;\n}\n\nexport interface WidgetType extends BaseWidgetType {\n  heading_i18n?: Translatable;\n  checkbox_label_i18n?: Translatable;\n  addon_label_i18n?: Translatable;\n}\n\nexport interface MultiWidgetType extends BaseWidgetType {\n  widget: \"checkboxes\" | \"select\";\n  choices?: [string, Translatable][];\n}\n\nexport interface Field {\n  name: string;\n  type: WidgetType;\n  default: string | null;\n  description_i18n: Translatable;\n  label_i18n: Translatable;\n  hide_label: boolean;\n  alts_enabled: boolean | null;\n}\n\nexport type WidgetProps<V = string, W = WidgetType> = {\n  value: V;\n  type: W;\n  placeholder?: V;\n  onChange: (value: SetStateAction<V>) => void;\n  disabled?: boolean;\n};\n\ninterface SerializableWidget {\n  deserializeValue?: (value: string, type: WidgetType) => string;\n  serializeValue?: (value: string, type: WidgetType) => string;\n}\n\ntype FakeWidget = ComponentType<{ field: Field }> &\n  SerializableWidget & {\n    isFakeWidget: true;\n  };\ntype RealWidget = ComponentType<WidgetProps> &\n  SerializableWidget & {\n    isFakeWidget: undefined;\n  };\nexport type WidgetComponent = FakeWidget | RealWidget;\n\nexport function getInputClass(type: WidgetType): string {\n  if (type.size === \"small\") {\n    return \"form-control form-control-sm\";\n  } else if (type.size === \"large\") {\n    return \"form-control form-control-lg\";\n  }\n  return \"form-control\";\n}\n","// extracted by mini-css-extract-plugin\nexport {};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"app\": 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunklektor\"] = self[\"webpackChunklektor\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"vendor\"], () => (__webpack_require__(\"./js/main.tsx\")))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n",""],"names":["React","forwardRef","memo","NavLink","useRecord","adminPath","AdminLink","ref","page","path","alt","children","otherProps","current","recordMatches","match","useCallback","useEffect","useRef","getKey","keyboardShortcutHandler","useKeyboardShortcut","key","action","handler","window","addEventListener","removeEventListener","useKeyboardShortcutRef","el","click","AdminLinkWithHotkey","shortcut","linkProps","useState","FindFiles","Publish","Refresh","subscribe","unsubscribe","DialogSlot","dialog","setDialog","dismiss","c","preventNavigation","prevent","d","detail","type","exhaustiveCheck","Error","SlideDialog","trans","ErrorDialog","error","setError","code","get","ServerStatus","serverIsUp","projectId","state","setState","onInterval","then","project_id","s","id","setInterval","clearInterval","title","hasCloseButton","ev","preventDefault","scrollTo","ToggleGroup","className","groupTitle","open","setOpen","toggle","event","v","useHistory","params","URLSearchParams","set","$LEKTOR_CONFIG","admin_root","useGoToAdminPage","history","name","push","createContext","PAGE_NAMES","isPageName","p","includes","PageContext","useContext","RecordContext","useRecordAlt","record","useRecordPath","apiUrl","post","trans_fallback","showErrorDialog","TargetServers","activeTarget","servers","setActiveTarget","onChange","target","value","serverOptions","map","server","name_i18n","short_target","BuildLog","log","buildLog","node","scrollTop","scrollHeight","join","setServers","setLog","length","onPublish","eventSource","EventSource","data","JSON","parse","close","concat","msg","isSafeToPublish","isSafeToNavigate","refresh","getCurrentLanguge","ResultRow","query","setQuery","results","setResults","selected","setSelected","goToAdminPage","ignore","q","lang","Math","min","onInputKey","item","result","idx","isActive","parents","dispatch","FetchError","console","document","dispatchEvent","CustomEvent","handleJSON","response","ok","json","credentials","headers","fetchJSON","input","method","init","undefined","body","stringify","fetch","endpoint","url","urlParams","Object","entries","forEach","toString","put","Crumb","targetPage","exists","label","label_i18n","AddNewPage","can_have_children","BreadCrumbs","segments","setSegments","resp","lastItem","getCanonicalUrl","findFiles","publish","onKeyPress","mac","GlobalActions","returnToWebsite","location","href","Header","sidebarIsActive","toggleSidebar","ca","de","en","es","fr","it","ja","ko","nl","pl","pt","ru","zh","translations","currentLanguage","currentTranslations","setCurrentLanguage","trans_obj","translation_object","fallback","trans_format","replacement","translation","replace","useMemo","ReactDOM","BrowserRouter","Redirect","useLocation","useRouteMatch","App","trimSlashes","Page","search","Main","root","dash","getElementById","render","Alternatives","alts","items","is_primary","primary_overlay","AttachmentActions","recordInfo","attachments","atch","ChildPagination","CHILDREN_PER_PAGE","ChildActions","allChildren","setPage","shownChildren","slice","child","numberOfChildren","pages","ceil","getPlatform","getBrowseButtonTitle","platform","BrowseFSLink","fsOpen","okay","alert","editKey","PageActions","is_attachment","can_be_deleted","can_have_attachments","useReducer","ChildPosCache","filter","r","unshift","childCount","find","compareAlternatives","a","b","nameA","nameB","Sidebar","setRecordInfo","childrenPage","setChildrenPage","childPosCache","x","updateForced","forceUpdate","sort","getPosition","rememberPosition","charmap","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","$","","","","","","multicharmap","pretty","remove","slugify","rawString","string","opts","lengths","keys","len","l","char","i","some","str","substr","formatUserLabel","inputConfig","iconData","isValidUrl","trimLeadingSlashes","exec","trimTrailingSlashes","trimColons","localPath","base","site_root","navigator","appVersion","indexOf","eventKey","altKey","ctrlKey","metaKey","getParentPath","AddAttachmentPage","newAttachmentInfo","setNewAttachmentInfo","fileInput","currentFiles","setCurrentFiles","isUploading","setIsUploading","currentProgress","setCurrentProgress","onFileSelected","files","Array","prototype","call","formData","FormData","append","file","xhr","XMLHttpRequest","onprogress","round","loaded","total","onload","send","display","EditPage","DeletePage","PreviewPage","AddChildPage","mainComponentForPage","edit","preview","upload","MainComponent","getSiteRootUrl","absRootUrl","URL","baseURI","usePreviewUrl","siteRootUrl","previewUrl","setPreviewUrl","iframe","contentWindow","onLoad","clone","KeyboardEvent","startsWith","url_path","substring","e","DOMException","AvailableModels","PrimaryField","Slug","alertErr","text","newChildInfo","setNewChildInfo","selectedModel","setSelectedModel","setId","primary","setPrimary","defaultModel","available_models","implied_model","primaryField","primary_field","createRecord","currentId","toLowerCase","_model","valid_id","available","values","localeCompare","model","getWidgetComponentWithFallback","field","Widget","deserializeValue","SlugInputWidget","placeholder","widget","size","DeletableAlternatives","DeletableAttachments","DeletableChildPages","DeleteAllAltsChoice","deleteMasterRecord","setDeleteMasterRecord","isAttachment","DeletePageActions","DeletePageHeader","deleteRecord","parent","targetPath","delete_master","cancelDelete","hasAlts","currentAlt","isPrimary","altInfo","Prompt","FieldBox","FieldRows","splitFields","EditPageActions","legalFields","recordDataModel","isLegalField","fields","getPlaceholderForField","slug_format","default_template","implied_attachment_type","getValueForField","recordData","getValues","rv","serializeValue","form","setRecordData","setRecordDataModel","setRecordnfo","hasPendingChanges","setHasPendingChanges","datamodel","record_info","requestSubmit","setFieldValue","fieldName","saveChanges","renderFormField","disabled","alts_enabled","normalFields","systemFields","IntegerInputWidget","MultiLineTextInputWidget","BooleanInputWidget","DateInputWidget","FloatInputWidget","UrlInputWidget","SingleLineTextInputWidget","CheckboxesInputWidget","SelectInputWidget","FlowWidget","LineWidget","SpacingWidget","InfoWidget","HeadingWidget","widgetComponents","datepicker","integer","checkbox","slug","flow","checkboxes","select","FallbackWidget","props","getFieldColumns","isFakeWidget","description","description_i18n","hide_label","getWidgetComponent","widthSpec","width","split","fraction","Number","isNaN","max","parseInt","processFields","rows","currentColumns","row","columns","renderFunc","isTrue","indeterminate","checked","checkbox_label_i18n","checkboxIsActive","flipSetValue","deserialize","trim","deserializedValue","deserializedPlaceholder","choices","newValue","InputWidgetBase","parseInteger","isValidDate","year","month","day","date","Date","getFullYear","getMonth","getDate","DATE_RE","validateDate","groups","REVERSE_DATE_RE","pad","n","postprocessDate","inputAddon","postprocessFloat","validateFloat","getInputClass","postprocessValue","inputType","validate","onChangeHandler","failure","setValidity","setCustomValidity","configuredAddon","addon_label_i18n","addon","postprocessInteger","validateInteger","onChangeProp","postprocessSlug","validateUrl","heading_i18n","AddFlowBlockButtons","flowblock_order","flowblocks","addBlock","models","button_label","FlowBlock","block","moveBlock","removeBlock","collapsed","bind","tokenize","serialize","parseFlowFormat","blocks","lines","blockName","blockLines","flush","line","blockStart","serializeFlowFormat","serialisedBlocks","deserializeFlowBlock","localId","rawData","serializeFlowBlock","flockBlockModel","offset","prevValue","newIndex","confirm","addNewBlock","flowBlockModel","newBlockId","newBlock","fieldValue","blockId","flowBlock","lineIsDashes","rawLine","processBuf","buf","lastLine","trimTabsAndSpaces","wantNewline","flushItem","trimRight","bits","rawKey","rest","firstBit","pop"],"sourceRoot":""}